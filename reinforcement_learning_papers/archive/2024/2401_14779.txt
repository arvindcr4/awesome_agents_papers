Lagrangian irreversibility and energy exchanges in rotating-stratified turbulent flows
S. Gallon,1 A. Sozza,1, 2 F. Feraco,3, 4 R. Marino,3 and A. Pumir1, 5
1

arXiv:2401.14779v1 [physics.flu-dyn] 26 Jan 2024

Univ Lyon, ENS de Lyon, CNRS, Laboratoire de Physique, F-69342 Lyon, France
2
CNR, Institute of Atmospheric Sciences and Climate, 10133 Torino, Italy
3
Univ Lyon, CNRS, École Centrale de Lyon, INSA de Lyon, Univ Claude Bernard Lyon 1,
Laboratoire de Mécanique des Fluides et d’Acoustique - UMR 5509, F-69134 Écully, France
4
Leibniz-Institute of Atmospheric Physics at the Rostock University, 18225 Kühlungsborn, Germany
5
Max Planck Institute for Dynamics and Self-Organization, 37077 Göttingen, Germany
(Dated: January 25, 2024)
Turbulence in stratified and rotating turbulent flows is characterized by an interplay between
waves and eddies, resulting in continuous exchanges between potential and kinetic energy. Here,
we study how these processes affect the turbulent energy cascade from large to small scales, which
manifests itself by an irreversible evolution of the relative kinetic energy between two tracer particles.
We find that when r0 , the separation between particles, is below a characteristic length ℓt , potential
energy is on average transferred to kinetic energy, reducing time irreversibility, and conversely when
r0 > ℓt . Our study reveals that the scale ℓt coincides with the buoyancy length scale LB over a
broad range of configurations until a transitional wave-dominated regime is reached.

The dynamics of rotating and stratified flows, as they
occur in the oceans on Earth, in planetary atmospheres
and in stars, depend strongly on their rotation rate, natural buoyancy frequency and the ratio between these physical parameters [1, 2]. These flows in nature are in general highly turbulent, with estimated Reynolds numbers
of at least Re > 109 for terrestrial oceans [3], involving a wide range of spatial scales, from the largest flow
structures of the order of tens of kilometers (or more in
astrophysical frameworks [4]), down to dissipative scales
of a few millimeters [3, 5, 6]. Much of our understanding of turbulent flows comes from studying the idealized
case of three-dimensional homogeneous isotropic turbulence (HIT), which has been postulated to describe the
properties of small-scale motions in the limit of very large
Reynolds numbers [7, 8]. In this case, flows are characterized by a flux of kinetic energy from large to small
scales, where dissipation occurs at a rate εν . The resulting cascade of energy introduces a fundamental irreversibility of the flow, which has a clear signature on the
relative motion of two tracer particles that are initially
separated by a distance r0 = |r(0)|. This property rests
on the identity relating the average of the scalar product
between their velocity and acceleration differences to the
energy dissipation rate ⟨∆r0 u · ∆r0 a⟩ ≈ −2εν , with the
Lagrangian acceleration a = D/Dt u, provided r0 is in
so-called inertial range [9–11]. This relation implies that
the relative kinetic energy of pairs of tracers, as well as
their separation ⟨(r(t) − r0 )2 ⟩, are not even functions of
time, which allows us to distinguish the time evolutions
forwards and backwards in time [12, 13]. We notice that
other manifestations of the time-irreversibility have been
obtained from Lagrangian turbulence [12, 14].
In geophysical frameworks, turbulent flows are subject
to stratification (STRAT) and rotation (ROT), which introduce waves that couple velocity (kinetic energy) and
density fluctuations (potential energy) [2, 15]. These

waves induce flow instabilities, and lead to the formation of strong vertical drafts, and to turbulence as a result of wave breaking [16–21]. Furthermore, they affect
the inter-scale energy transfer leading in some cases to
inverse or dual kinetic and/or potential energy cascades
[22–24]. Here, we investigate the interaction between kinetic u2 /2 and potential energy θ2 /2 in the flow, their
effect on the turbulent cascade and the resulting irreversibility. We revisit the energy budget for such flows
using the Boussinesq approximation [2], thereby generalizing the Karman-Howarth-Monin relations to the Lagrangian framework [25]. We establish that the timesymmetry breaking term involves not only the energy
dissipation εν , but also an exchange term between potential and kinetic energy.
Numerically, we study the influence of waves and turbulence, keeping fixed the ratio between stratification
and rotation in a configuration of oceanographic relevance [26, 27]. In a flow forced by injecting kinetic energy, we observe that at large scales, energy is transferred
on average from kinetic to potential energy. We find at
smaller scales an inversion of the flux, i.e. from potential
to kinetic energy, which is in qualitative agreement with
previous numerical observations in spectral space [28–32].
This inversion allows us to identify a characteristic length
scale ℓt of the flow, which we relate to the typical vertical length scale of stratification layers and therefore the
complex interactions of waves and vortices [31, 33, 34].
We perform direct numerical simulations (DNS) of the
Boussinesq equations in a rotating frame, with constant
solid body rotation rate Ω (and frequency f = 2Ω) and
gravity g anti-aligned in the vertical (z) direction. The
fluid is linearly stably stratified, subjected to a mean density profile ρ = ρ0 − γz, parameterized by the BruntVäisälä frequency N = (γg/ρ0 )1/2 . The equations of
motion for the incompressible velocity field u(x, t) =
(u, v, w) (e.g. ∇ · u = 0) and the density fluctuation

2
TABLE I. Parameters of the runs. N Brunt-Väisäilä frequency, ν kinematic viscosity, εν kinetic energy dissipation rate (averaged
over particle integration time), Fr Froude number, Re Reynolds number, RIB Buoyancy Reynolds number, ℓO Ozmidov scale.
Runs A0 - A4 where run at a grid resolution of M = 512, runs B0 - B4 at M = 1024. We set the viscosity to ν = 1.5 · 10−3 for
run A0, ν = 1 · 10−3 for runs A0-A4 and ν = 2.1 · 10−4 for runs B0-B1. We integrated the trajectories of 1.5 · 106 particles for
runs A0-A4 and 6 · 106 particles for runs B0-B4. All simulations have been run for at least 4.5 eddy turnover times after the
insertion of the particles.
Run
N
εν
Fr
Re
RIB
η
ℓO
LB

A0
0
0.375
∞
2380
∞
0.00974
∞
∞

A1
2.95
0.206
0.169
3140
23.8
0.00834
0.0700
0.424

A2
4.92
0.156
0.105
3270
6.47
0.00894
0.0318
0.264

A3
7.37
0.123
0.0777
3620
2.26
0.00950
0.0167
0.195

A4
14.7
0.0237
0.0410
3820
0.109
0.0143
0.00161
0.103

field θ(x, t) = (γ/N )(ρ − ρ) read
∂t u + u · ∇u = −∇p − f ez × u

(1)

∂t θ + u · ∇θ = N w + κ∇2 θ,

(2)

2

− N θez + ν∇ u + Φ,

where p(x, t) denotes the reduced pressure, ν the kinematic viscosity and κ thermal diffusivity. Here, we choose
ν = κ, or equivalently, Pr = ν/κ = 1. Equations (2),
(1) are integrated in a triply periodic box of resolution M = 512, 1024 by means of the pseudo-spectral
solver GHOST (Geophysical High-Order Suite for Turbulence) [35] with a 2-nd order explicit Runge-Kutta
scheme for the time stepping. To sustain turbulence and
to achieve a statistically stationary state, an external mechanical isotropic forcing Φ(x, t) is included to inject energy at large scale in a narrow wave number band within
the range 2 ≤ kΦ ≤ 3, hence the resulting characteristic
forcing length scale LΦ = 2π/2.5. The rate of kinetic
energy injection reads εΦ = ⟨u · Φ⟩. To quantify the relative strength of turbulence, stratification and rotation,
we consider the dimensionless Reynolds (Re), Froude (Fr)
and Rossby (Ro) numbers at forcing scale LΦ , given by
Re =

u′ LΦ
,
ν

Fr =

u′
,
LΦ N

Ro =

u′
,
LΦ f

(3)

where u′ , defined as the root mean square of the velocity
2
fluctuation u′ = ⟨|u| ⟩1/2 , is the characteristic velocity of
the large-scale flow. The ratio N/f = Ro/Fr measures
the relative strength of stratification and rotation. In
the present simulations, we chose to fix N/f = 5, which
is found in the Southern Ocean [26, 27]. The typical
vertical length scale of stratification layers is given by
the buoyancy scale [31, 33]
LB = u′ /N .

(4)

To compare the relative strength of stratification and dissipation on small scales, i.e. the relative importance of

B0
0
0.00784
∞
4790
∞
0.00586
∞
∞

B1
1.18
0.00932
0.155
5510
31.9
0.00561
0.00791
0.390

B2
2.95
0.00715
0.0823
7300
3.92
0.00600
0.00243
0.207

B3
7.37
0.0136
0.0599
13300
1.19
0.00511
0.00185
0.151

B4
14.7
0.0344
0.0356
15800
0.755
0.00405
0.00234
0.0896

internal-gravity waves and vortices, we define the buoyancy Reynolds number RIB = εν /(νN 2 ) [2], which is
related to the ratio between the Ozmidov scale ℓO =
(εν /N 3 )1/2 and the Kolmogorov scale η = (ν 3 /εν )1/4 as
RIB = (ℓO /η)4/3 . The former is the length scale below which stratification effects become negligible and the
flow recovers isotropy, while the latter is the characteristic scale for dissipation. Alternatively, RIB can be interpreted as a ratio between times as RIB = (τη N )−2 ,
namely the viscous time τη = (ν/εν )1/2 and the typical
time of the internal gravity waves ∼ 1/N . For the dynamics of single tracer particles, at transition between
a wave-dominated (RIB < 0) and an eddy-dominated
regime (RIB > 0) was recently observed [36]. The buoyancy Reynolds number RIB used here is related to, but
differs from RB = ReFr2 , see [37].
To ensure that our simulations are satisfactorily resolved, we kept kmax η ≳ 2, where kmax = M/3 is the
largest wavenumber in the simulation. We choose a time
increment dt sufficiently small so that the fastest waves
are well resolved. The simulation parameters are summarized in table I.
While solving the Boussinesq equations (eqs. (1), (2)),
we follow the trajectories of Np ≳ 106 tracer particles,
initially randomly distributed throughout the system.
To obtain information of particle pairs from trajectories
both forwards and backwards in time, we identify, at specific times, pairs of particles whose relative distance is
within a chosen range of distance r − ∆r ≤ |r| ≤ r + ∆r
with the tolerance ∆r. For large databases, the computation time to compute all relative distances grows rapidly.
For an efficient parallelized approach to this challenge we
refer to [38]. Here, we focus on single processor optimization by employing a novel algorithm using hierarchical
spatial domain partitioning with an octree data structure [39]. In test runs with synthetic data, we observed
a reduction of computational time by a factor of up to

3

FIG. 1. Time anti-symmetric part of relative pair dispersion for different initial separations r0 within the inertial range
(indicated by color), compensated by the HIT prediction using ⟨∆r0 u · ∆r0 a⟩ = −2εν . Compare with the previously studied
HIT case [12]. The left panel shows run B1, with only small differences to the HIT case [12], the right panel shows, run B2 in
table I showing a scale dependency of the pair dispersion time asymmetry. The inlets demonstrate the validity of the Taylor
expansion in eq. (5) for both cases. Here, we used a different set of pairs to estimate Ψ(r0 , t) and ⟨∆r0 u · ∆r0 a⟩ to avoid biasing
the analysis.

103 , depending on various parameters such as Np , r and
∆r. For a short description of the algorithm we refer to
the supplemental material [40], for more details see [41].
For the analysis presented in the following, we chose the
tolerances ∆r0 ∝ r0 −2 to keep the number of pairs independent of r0 . As a reference, we chose ∆r0 = 0.005η
for r0 = 10η. We averaged over ∼ 106 pairs per run
and distance r0 that are taken, assuming a statistically
stationary flow, from 256 snapshots of the simulation.
A measure of the relative dispersion of two particles
is provided by the evolution of the squared separation
2
δr0 r(t)2 = (r(t) − r0 ) , imposing that the initial separation r(0) = r0 [12, 42–45]. Focusing on short times, a
straightforward Taylor series expansion leads to:
2

δr0 r(t)2 ≈ (∆r0 u) t2 + (∆r0 u · ∆r0 a)t3 ,

(5)

where ∆r0 u and ∆r0 a denote the initial value of the pairs
relative velocity and acceleration respectively [42]. Note
that eq. (5) holds for the motion of particle pairs in any
Newtonian system. By averaging over all pairs of particles with the same initial separation, the cubic term
in eq. (5) provides a direct connection with the intrinsic time-asymmetry of the flow, as it was the case for
HIT [12]. Inserting eq. (5) we obtain, for the function Ψ
characterizing the asymmetry of δr0 r(t)2 :
Ψ(r0 , t) ≡ ⟨δr0 r2 (−t) − δr0 r2 (t)⟩ ≈ −2⟨∆r0 u · ∆r0 a⟩t3 .
(6)
The approximate expression eq. (5) is estimated
to remain valid over the Bachelor time tB (r0 ) =
2

⟨(∆r0 u) ⟩/⟨∆r0 u · ∆r0 a⟩ [42, 46]. For HIT, assuming
2

2/3 2/3

⟨(∆r0 u) ⟩ ∝ εν r0 and ⟨∆r0 u · ∆r0 a⟩ = −2εν , tB re−1/3
duces to the Kolmogorov time: tB (r0 ) ∝ εν r2/3 = τr0 .
2
For ROTSTRAT turbulence, ⟨(∆r0 u) ⟩ follows a different scaling law with r0 [2, 24]. Here, we merely determine

2

tB as the ratio between ⟨(∆r0 u) ⟩ and ⟨∆r0 u · ∆r0 a⟩,
measured from our own simulations.
Figure 1 shows that contrary to the HIT case, where
Ψ(r0 , t)/t3 ≈ 4εν is independent of r0 , provided that r0 is
in the inertial range and t ≪ tB [12], in the ROTSTRAT
case, Ψ(r0 , t)/t3 is a function of r0 , which increases with
the initial separation r0 , the more so as Fr decreases.
In eq. (6), we identify the average rate of change of the
(r )
pairs kinetic energy ⟨D/Dt Ekin0 ⟩ = ⟨∆r0 u · ∆r0 a⟩. To
proceed, we extend the one-particle energy budget to the
pair energy budget. The former is obtained by averaging the Boussinesq equations (eqs. (1), (2)). Assuming
homogeneity and stationarity, one finds (see [40]):
εΦ − εν − N ⟨θw⟩ = 0

and N ⟨θw⟩ − εκ = 0,

(7)

where εΦ is the energy source, and εν and εκ are respectively the dissipation terms for the kinetic and potential
energy. The exchange term N ⟨θw⟩ represents the amount
of kinetic energy converted into potential energy. This
term is positive and equal to the amount of dissipated
potential energy εκ [25]. The Lagrangian two-point energy budget, describing the transfer of energy between
two particles, generalizes the classical Karman-HowarthMonin relations. By averaging over the Boussinesq equations (eqs. (1), (2)), assuming homogeneity and stationarity [9, 25, 47], we obtain (see [40]):
⟨∆r0 u · ∆r0 a⟩ = −2εν − N ⟨∆r0 θ∆r0 w⟩ − 2Dν (r0 ), (8)
D
E
∆r0 θ · ∆r0 θ̇ = −2εκ + N ⟨∆r0 θ∆r0 w⟩ − 2Dκ (r0 ), (9)

with
terms Dν (r0 )
=
E
DP the mixed dissipation
∂ui (x) ∂ui (x+r)
and
Dκ (r0 )
=
ν
∂xj
DPi,j ∂xj
E
∂θ(x) ∂θ(x+r)
κ
.
We assume the gradients to
j ∂xj
∂xj
decorrelate quickly for sufficiently large separations r0 ,

4

FIG. 2. Kinetic energy budget (first row) and exchange term (second row) for all runs. The left column shows the observations
for the M = 512 runs (A0-A4) (diamonds), the right column those for the M = 1024 runs (B0-B4) (circles). Colors indicate
different values of RIB , as indicated in the legend. The shaded areas indicate the standard deviation computed averaging over
4 subsets. The lines correspond to the average over the whole data set. Furthermore, the dotted gray line in the second row
denotes a vanishing energy exchange, i.e. N ⟨∆r0 θ∆r0 w⟩ = 0.

such that the mixed dissipation terms can be neglected.
In the absence of stratification, the Karman-HowarthMonin relation reduces to the well-known relation
⟨∆r0 u · ∆r0 a⟩ = −2εν ., valid in HIT. Furthermore, we
note that all rotational terms vanish.
The signs of the various terms in eqs. (8), (9) determine the direction of the transfer. The negative sign of
−2εν is the signature of the presence of a direct energy
cascade. We remark that in two-dimensional turbulence,
the sign of the cross-correlation between acceleration and
velocity is inverted. This is a consequence of the correlation between velocity and dissipation at large scales,
whereas forcing acts at a much smaller scale, from which
energy flux arranges in an inverse cascade [48, 49].
In our simulations, we observe the sum −[⟨∆r0 u ·
∆r0 a⟩ + N ⟨∆r0 w∆r0 θ⟩]/2εν to be constant and close to
unity over a certain range of scales (which increases with
the Re) for runs with RIB > 1, as shown in the first
row of fig. 2. According to eq. (8), this term is equal
to 1 + Dν (r0 )/(2εν ) and can thus be seen as the full kinetic energy budget. For the cases considered here with
RIB < 1, we observe a stronger deviation from 1, possibly pointing to a transition to a different energy transfer
mechanism.
Judging from eqs. (8), (9), the term N ⟨∆r0 θ∆r0 w⟩,
represents an average exchange from kinetic to potential
energy if positive, or conversely if negative. In our simulations, we observe for large separations in the inertial
range the average energy exchange to be positive, i.e.
converting kinetic energy to potential energy. For small

separations and RIB > 1, however, we observe a negative average energy exchange, hence transferring energy
in the opposite direction, i.e. from potential to kinetic
energy, as shown in the second row of fig. 2. This result is
consistent with other observations from Eulerian studies
in spectral space [28–32].
We now consider the transition length scale ℓt , where
the change of sign occurs, i.e. N ⟨∆ℓt θ∆ℓt w⟩ = 0. Figure 3 shows the ratio between ℓt and the buoyancy lengthscale LB as a function of RIB . Although the ratio ℓt /LB
is not strictly constant, it remains of order 1 throughout
the simulations with RIB > 1, where 0.035 ≲ Fr ≲ 0.17.
This suggests that the mechanism leading to the energy
exchange results from the complex interactions between
internal gravity waves and turbulent eddies. The connection even prevails very close to the transition at RIB = 1
(see run B3 and B4). At even lower RIB , we see a transition to a different regime. Furthermore, at the largest
value of RIB studied here, ℓt /LB deviates more from ∼ 1
than for the runs at lower values of RIB . In addition, we
remark that run B1 (full, yellow line with circles in fig. 2)
shows a reduced exchange term at small scales compared
to the other runs. This may indicate a different behavior,
due to the large value of RIB .
The observed energy exchange directly influences the
time asymmetry in particle dispersion Ψ(r0 , t), and explains the differences to the previously studied case of
HIT [12]. For separations r0 > LB , the average energy
transfer is directed from kinetic to potential energy and
increases with r0 . This explains the observed increase

5

FIG. 3. Length scale ℓt at which the exchange term changes
compensated by the buoyancy length scale LB as a function
of RIB

of Ψ(r0 , t) with increasing r0 in fig. 1. For separations
η < r0 < LB , the energy transfer is from potential to
kinetic energy, symmetrically increasing and decreasing
pair dispersion backwards and forwards in time and are
therefore reducing the pair asymmetry Ψ(r0 , t).
A precise description of the energy exchanges in rotating stratified turbulent flows is crucial to understand the
interplay between waves and eddies. Remarkably, our
work stresses the role of the buoyancy length scale, LB ,
over a broad range of RIB from an eddy dominated regime
(RIB ≳ 10) [15] until the transitional regime to wavedominated flows (RIB ≲ 1). Interesting questions for
future investigation are whether our conclusions extend
to the range 100 ≲ RIB ≲ 1000, corresponding to measurements in the oceans [50] and to similar values of RIB
at higher Re and lower Fr. We conclude by noticing that
the time-asymmetry of the relative energy between two
tracer particles could be used to measure the energy dissipation rate, εν , in terrestrial or planetary flows [51, 52].
In this context, understanding of the exchange between
kinetic and potential energy in such flows appears as an
important step.
S.G. acknowledges the ”Fond Recherche” of ENS Lyon
for financial support. A.S. acknowledges support from
the post-doctoral fellowship program LABEX MILYON
of the Université de Lyon. R.M. and F.F. acknowledge support from the project “EVENTFUL” (ANR-20CE30-0011), funded by the French “Agence Nationale de
la Recherche” - ANR through the program AAPG-2020.x
The computing resources utilized in this work were provided by PSMN at the École Normale Superieure de Lyon
and PMCS2I at the École Centrale de Lyon.

[1] J. Pedlosky, Geophysical Fluid Dechanics (Springer Verlag, New York, 1092).
[2] P. A. Davidson, Turbulence in Rotating, Stratified and

Electrically Conducting Fluids (Cambridge University
Press, Cambridge, 2013).
[3] S. A. Thorpe, An Introduction to Ocean Turbulence
(Cambridge University Press, Cambridge, 2007).
[4] M. S. Miesch, Large-Scale Dynamics of the Convection
Zone and Tachocline, Living Reviews in Solar Physics 2,
1 (2005).
[5] A. S. Monin and A. M. Yaglom, Statistical Fluid Mechanics, Volume II: Mechanics of Turbulence, Vol. 2 (Courier
Corporation, 2013).
[6] U. Frisch, Turbulence: The Legacy of A. N. Kolmogorov
(Cambridge University Press, 1995).
[7] G. I. Taylor, Statistical theory of turbulenc, Proceedings
of the Royal Society of London. Series A - Mathematical
and Physical Sciences 151, 421 (1935).
[8] A. Kolmogorov, The Local Structure of Turbulence in
Incompressible Viscous Fluid for Very Large Reynolds’
Numbers, Akademiia Nauk SSSR Doklady 30, 301
(1941).
[9] J. Mann, S. Ott, and J. S. Andersen, Experimental Study
of Relative, Turbulent Diffusion, Report 87-550-2370-3
(Risø National Laboratory, Roskilde, Denmark, 1999).
[10] G. Falkovich, K. Gawȩdzki, and M. Vergassola, Particles
and fields in fluid turbulence, Reviews of Modern Physics
73, 913 (2001).
[11] A. Pumir, B. I. Shraiman, and M. Chertkov, The Lagrangian view of energy transfer in turbulent flow, Europhysics Letters 56, 379 (2001).
[12] J. Jucha, H. Xu, A. Pumir, and E. Bodenschatz, Timereversal-symmetry Breaking in Turbulence, Physical Review Letters 113, 054501 (2014).
[13] A. Cheminet, D. Geneste, A. Barlet, Y. Ostovan,
T. Chaabo, V. Valori, P. Debue, C. Cuvier, F. Daviaud, J.-M. Foucaut, J.-P. Laval, V. Padilla, C. WiertelGasquet, and B. Dubrulle, Eulerian vs Lagrangian Irreversibility in an Experimental Turbulent Swirling Flow,
Physical Review Letters 129, 124501 (2022).
[14] H. Xu, A. Pumir, G. Falkovich, E. Bodenschatz,
M. Shats, H. Xia, N. Francois, and G. Boffetta,
Flight–crash events in turbulence, Proceedings of the National Academy of Sciences 111, 7558 (2014).
[15] A. Pouquet, D. Rosenberg, R. Marino, and C. Herbert,
Scaling laws for mixing and dissipation in unforced rotating stratified turbulence, J. Fluid Mech. 844, 519 (2018).
[16] C. Rorai, P. D. Mininni, and A. Pouquet, Turbulence
comes in bursts in stably stratified flows, Physical Review
E 89, 043002 (2014).
[17] T. Dauxois, S. Joubaud, P. Odier, and A. Venaille, Instabilities of internal gravity wave beams, Annual review
of fluid mechanics 50, 131 (2018).
[18] F. Feraco, R. Marino, L. Primavera, A. Pumir,
P. D. Mininni,
D. Rosenberg,
A. Pouquet,
R. Foldes, E. Lévêque, E. Camporeale, S. S. Cerri,
H. Charuvil Asokan, J. L. Chau, J. P. Bertoglio, P. Salizzoni, and M. Marro, Connecting large-scale velocity
and temperature bursts with small-scale intermittency
in stratified turbulence, EPL (Europhysics Letters) 135,
14001 (2021).
[19] C. P. Caulfield, Layering, instabilities, and mixing in turbulent stratified flows, Annual Review of Fluid Mechanics
53, 113 (2021), https://doi.org/10.1146/annurev-fluid042320-100458.
[20] R. Marino, F. Feraco, L. Primavera, A. Pumir, A. Pouquet, D. Rosenberg, and P. D. Mininni, Turbulence gener-

6
ation by large-scale extreme vertical drafts and the modulation of local energy dissipation in stably stratified geophysical flows, Physical Review Fluids 7, 033801 (2022).
[21] J. R. Taylor and A. F. Thompson, Submesoscale dynamics in the upper ocean, Annual Review of Fluid Mechanics
55, 103 (2023), https://doi.org/10.1146/annurev-fluid031422-095147.
[22] R. Marino, P. D. Mininni, D. Rosenberg, and A. Pouquet,
Inverse cascades in rotating stratified turbulence: Fast
growth of large scales, EPL (Europhysics Letters) 102,
44006 (2013).
[23] R. Marino, A. Pouquet, and D. Rosenberg, Resolving the
paradox of oceanic large-scale balance and small-scale
mixing, Phys. Rev. Lett. 114, 114504 (2015).
[24] A. Alexakis and L. Biferale, Cascades and transitions in
turbulent flows, Physics Reports Cascades and Transitions in Turbulent Flows, 767–769, 1 (2018).
[25] A. Sozza, G. Boffetta, P. Muratore-Ginanneschi, and
S. Musacchio, Dimensional transition of energy cascades
in stably stratified forced thin fluid layers, Physics of Fluids 27, 035112 (2015).
[26] A. C. Naveira Garabato, K. L. Polzin, B. A. King, K. J.
Heywood, and M. Visbeck, Widespread Intense Turbulent Mixing in the Southern Ocean, Science 303, 210
(2004).
[27] M. Nikurashin, G. K. Vallis, and A. Adcroft, Routes to
energy dissipation for geostrophic flows in the Southern
Ocean, Nature Geoscience 6, 48 (2013).
[28] G. Holloway, The buoyancy flux from internal gravity
wave breaking, Dynamics of Atmospheres and Oceans 12,
107 (1988).
[29] C. Staquet and F. S. Godeferd, Statistical modelling and
direct numerical simulations of decaying stably stratified
turbulence. Part 1. Flow energetics, Journal of Fluid Mechanics 360, 295 (1998).
[30] G. F. Carnevale, M. Briscolini, and P. Orlandi,
Buoyancy- to inertial-range transition in forced stratified
turbulence, Journal of Fluid Mechanics 427, 205 (2001).
[31] G. Brethouwer, P. Billant, E. Lindborg, and J.-M.
Chomaz, Scaling analysis and simulation of strongly
stratified turbulent flows, Journal of Fluid Mechanics
585, 343 (2007).
[32] C. Rorai, P. D. Mininni, and A. Pouquet, Stably stratified
turbulence in the presence of large-scale forcing, Physical
Review E 92, 013003 (2015).
[33] P. Billant and J.-M. Chomaz, Self-similarity of strongly
stratified inviscid flows, Physics of Fluids 13, 1645
(2001).
[34] M. L. Waite, Stratified turbulence at the buoyancy scale,
Physics of Fluids 23, 066602 (2011).
[35] P. D. Mininni, D. Rosenberg, R. Reddy, and A. Pouquet, A hybrid MPI–OpenMP scheme for scalable parallel pseudospectral computations for fluid turbulence,
Parallel Computing 37, 316 (2011).
[36] D. Buaria, A. Pumir, F. Feraco, R. Marino, A. Pouquet, D. Rosenberg, and L. Primavera, Single-particle
Lagrangian statistics from direct numerical simulations
of rotating-stratified turbulence, Physical Review Fluids
5, 064801 (2020).
[37] G. N. Ivey, K. B. Winters, and J. R. Koseff, Density
Stratification, Turbulence, but How Much Mixing?, Annual Review of Fluid Mechanics 40, 169 (2008).
[38] D. Buaria, B. L. Sawford, and P. K. Yeung, Characteristics of backward and forward two-particle relative disper-

sion in turbulence at different Reynolds numbers, Physics
of Fluids 27, 105101 (2015).
[39] R. A. Finkel and J. L. Bentley, Quad trees a data structure for retrieval on composite keys, Acta Informatica 4,
1 (1974).
[40] Supplemental material.
[41] S. Gallon, Ph.D. thesis (In preparation).
[42] G. K. Batchelor, The application of the similarity theory
of turbulence to atmospheric diffusion, Quarterly Journal
of the Royal Meteorological Society 76, 133 (1950).
[43] M. Bourgoin, N. T. Ouellette, H. Xu, J. Berg, and E. Bodenschatz, The Role of Pair Dispersion in Turbulent
Flow, Science 311, 835 (2006).
[44] N. T. Ouellette, H. Xu, M. Bourgoin, and E. Bodenschatz, An experimental study of turbulent relative dispersion models, New Journal of Physics 8, 109 (2006).
[45] J. I. Polanco, S. Arun, and A. Naso, Multiparticle Lagrangian statistics in homogeneous rotating turbulence,
Physical Review Fluids 8, 034602 (2023).
[46] R. Bitane, H. Homann, and J. Bec, Time scales of turbulent relative dispersion, Physical Review E 86, 045302(R)
(2012).
[47] R. J. Hill, Exact second-order structure-function relationships, Journal of Fluid Mechanics 468, 317 (2002).
[48] D. Bernard, Three-point velocity correlation functions
in two-dimensional forced turbulence, Physical Review
E 60, 6184 (1999).
[49] A. D. Bragg, F. De Lillo, and G. Boffetta, Irreversibility
inversions in two-dimensional turbulence, Physical Review Fluids 3, 024302 (2018).
[50] J. N. Moum, Energy-containing scales of turbulence in
the ocean thermocline, J. Geophys. Res 101, 14095
(1996).
[51] B. C. Pearson, J. L. Pearson, and B. Fox-Kemper, Advective structure functions in anisotropic two-dimensional
turbulence, Journal of Fluid Mechanics 916, A49 (2021).
[52] B. Pearson, C. Wagner, J. Pearson, N. Rodriguez, S. Alshenaiber, and B. Fox-Kemper, A new method to diagnose turbulent cascade rates in mesoscale ocean systems
and planetary atmospheres (2023).
[53] L. D. Landau and E. M. Lifshitz, Fluid Mechanics, 2nd
ed., Course of Theoretical Physics, Vol. 6 (ButterworthHeinemann, Amsterdam Heidelberg, 1987).

Supplemental Material for:
Lagrangian irreversibility and energy exchanges in rotating-stratified turbulent flows
S. Gallon,1 A. Sozza,1, 2 F. Feraco,3, 4 R. Marino,3 and A. Pumir1, 5

arXiv:2401.14779v1 [physics.flu-dyn] 26 Jan 2024

1

Univ Lyon, ENS de Lyon, CNRS, Laboratoire de Physique, F-69342 Lyon, France
2
CNR, Institute of Atmospheric Sciences and Climate, 10133 Torino, Italy
3
Univ Lyon, CNRS, École Centrale de Lyon, INSA de Lyon, Univ Claude Bernard Lyon 1,
Laboratoire de Mécanique des Fluides et d’Acoustique - UMR 5509, F-69134 Écully, France
4
Leibniz-Institute of Atmospheric Physics at the Rostock University, 18225 Kühlungsborn, Germany
5
Max Planck Institute for Dynamics and Self-Organization, 37077 Göttingen, Germany
(Dated: January 25, 2024)

OCTREE BASED ALGORITHM FOR PARTICLE PAIR IDENTIFICATION

Experimental and numerical studies of turbulent flows often generate very large databases. The present investigation
in Lagrangian turbulence relies on the analysis of millions of particle trajectories. Extracting meaningful information
on the structure of the flow, as a function of scale r, rests on the capability to identify sets of particles separated by a
distance r, up to a tolerance ∆r. The corresponding search through the database, however, can be a very expensive
task, the more so as the total number of particles Np , increases. This calls for the development of efficient methods
to search through the database.
A way to reduce computational costs is to divide the domain into sub-domains, e.g. into sub-cubes of edge length
ℓ and sort all the particles into these sub-cubes. When r + ∆r < ℓ, the particles within a distance between r − ∆r
and r + ∆r from a given particle p1 are either in the same sub-cube as p1 or in one of the neighboring 26 sub-cubes.
Restricting the search to these sub-cubes can lead to a significant reduction of the computational effort. To further
improve the performance especially for larger separations r between particles, we propose a search algorithm based on
the octree data structure [1]. Within this approach, the original cubic domain, [0, 2π]3 , is subdivided into 8 sub-cubes
with each half the original side length. The original cube is referred to as the root node and the sub-cubes as its
children. Each of the children nodes is then itself recursively subdivided into 8 sub-cubes per generation, with each
half the side length of the previous generation. The process is repeated for a total of m times. The particles are
then sorted into the 8m smallest sub-cubes (leaf nodes). For the present application, we assume the particles to be
uniformly distributed (note that for some other applications of the octree-data structure, the number of refinements
is chosen locally based on the local particle density). To choose the number of refinements m, we found that the
method works efficiently with at least ∼ 10 particles per cube on the smallest level.
Particles at a separation within [r − ∆r, r + ∆r] to a particle p1 are located in a shell, as represented for the
two-dimensional case in fig. 1(a). To find these particles, we start at the root node and descent in the tree to the child
node that contains the position of p1 . We repeat this descent until we arrive at a node whose side length ℓi fulfills
ℓi /2 < r + ∆r < ℓi , which is the node with the smallest side length that is still larger than the maximum search
distance r + ∆r. All particles that are at distance r ± ∆r to p1 can therefore be only either within this node, or within
one of its neighbors , see fig. 1(b). We then look for all the nodes of smaller size that intersect with the shell by the
following recursive approach. A given node can contain a particle at a distance between r − ∆r and r + ∆r from a
particle p1 only if it has an intersection with the shell represented in fig. 1. Therefore, if a node is either too close or
too far away from p1 , itself and its children can be discarded. The children of the nodes that have an intersection with
the shell are considered in the next step, using the same procedure until the leaf nodes are reached (see fig. 1(c-f)).
To finalize the search, we compute the distances of the particles in the remaining nodes to p1 to find all pair partners.
This procedure is repeated for all p1 to find all possible pairs. To avoid double counting, we only keep pairs with
increasing indices, i.e. p1 < p2 .

DERIVATION OF THE PAIR ENERGY BUDGET

In this work, we consider a stably stratified fluid with a linear density profile ρ = ρ0 − γz in a rotating frame
of reference with solid body rotation rate Ω (and frequency f = 2Ω). In this case, the equations of motion for the

2

FIG. 1. Exemplary depiction of the pair search algorithm using a quadtree-data structure in two dimensions. (a-f) The blue
point with black edge is the particle p1, the shell of distances r ± ∆r is colored in blue. (b-f) Iterative search using the quadtree
data structure. The hatched regions are the nodes that intersect with the shell in the respective generation.

incompressible velocity field u = (u, v, w), i.e. ∇ · u = 0 and density fluctuation θ = (γ/N )(ρ − ρ) read
∂t u + u · ∇u = −∇p − f ez × u − N θez + ν∇2 u + Φ,
2

∂t θ + u · ∇θ = N w + κ∇ θ,

(1)
(2)

with the reduced pressure p, the Brunt-Väisälä frequency N = (γg/ρ0 )1/2 , the kinematic viscosity ν, the external
forcing Φ and the thermal diffusivity κ.
In the following, we derive the energy budget for the relative kinetic and potential energy for two particles separated
by r. For the original Eulerian work, we refer to [2].
One Particle Energy Budget
D
u = ∂t u + u · ∇u. The rate of
We start by considering a single particle with velocity u and acceleration a = Dt
2
change of the kinetic energy Ekin = u /2 of this particle along its trajectory is given by

D
Ekin = u · a.
Dt
Averaging this quantity over many particles and inserting the equation of motion, we obtain


D
Ekin = − ⟨u · ∇p⟩ − ⟨u · f ez × u⟩ − ⟨u · N θez ⟩ + u · ν∇2 u + ⟨u · Φ⟩ .
Dt

(3)

(4)

3
The first term on the right hand side of eq. (4) can be rewritten as
⟨u · ∇p⟩ = ∇ · ⟨u · p⟩ − ⟨p∇ · u⟩ = 0,

(5)

and therefore vanishes due to homogeneity (first term) and incompressibility (second term).
The second term on the right hand side of eq. (4) is zero for geometric reasons (u · ez × u = 0).
The third term on the right hand side of eq. (4) represents the energy exchange between potential and kinetic
energy. For a more compact notation, we introduce
εχ ≡ ⟨u · N θez ⟩ = N ⟨wθ⟩ ,

(6)

where w denotes the vertical velocity component. With our sign conventions, εχ represents a sink of kinetic energy
and a source of potential energy for εχ > 0.
The fourth term on the right hand side of eq. (4) describes the energy dissipation by viscosity
D
E
ν
2
(7)
u · ν∇2 u = ∇2 (u) − εν .
2
The first term on the right hand side of the equation above vanishes due to homogeneity. Furthermore we introduced
the kinetic energy dissipation rate
*
+
X  ∂ui 2
εν ≡ ν
.
(8)
∂xj
i,j

Finally, the remaining term on the right hand side of eq. (4) is the insertion of energy due to the large scale forcing
Φ. For a more compact notation, we introduce
εΦ ≡ ⟨u · Φ⟩ .

(9)

Putting everything together, we arrive at the one point budget for the kinetic energy


D
Ekin = ⟨u · a⟩ = εΦ − εχ − εν .
Dt

(10)

For the potential energy Epot = θ2 /2, we rewrite the thermal diffusive term similarly to the viscous term and directly
obtain similarly the budget


D
Epot = ⟨θθ̇⟩ = εχ − εκ ,
(11)
Dt
with the potential energy dissipation rate
εκ ≡ κ

*

X  ∂θ 2
j

∂xj

+

.

(12)

Two Particle Energy Budget

We now consider a pair of particles with positions x(1) (t) and x(2) (t), separated by a displacement r(t), where
(r)
|r(0)| = r is in the inertial range, and study the evolution of the relative kinetic energy of this pair Ekin = ∆r u2 /2:
D (2)
E = ∆r u · ∆r a,
Dt kin

(13)

where we have used the notation ∆r q ≡ q (2) − q (1) for any observable q. Averaging eq. (13) over many pairs with the
same separation r, and using the Boussinesq equations, one obtains:


D
E
D
E
D
E
D
E
D (2)
Ekin
= u(2) · a(2) − u(2) · a(1) − u(1) · a(2) + u(1) · a(1)
.
(14)
Dt
r
r
r
r
r

4
Note that we are not only prescribing here the length of r, but also its orientation. The first and last term on the
right hand side of eq. (14) are the rates of change of the kinetic energy of each of the two particles separately. Because
of statistical homogeneity, they are independent of the initial separation r and therefore each term is given by the
single particle budget for the kinetic energy derived above:
E
D
E
D
u(2) · a(2) = u(1) · a(1) = εΦ − εχ − εν .
r

(15)

r

To evaluate the mixed terms on the right hand side of eq. (14), we first use arguments similar to those used for the
one-particle energy budget to show that pressure terms do not contribute. As an example:
D
E
D
E
D
E
u(2) ∇(1) p(1) = ∇(1) · u(2) p(1) − p(2) ∇(2) · u(1) = 0,
r

r

r

(16)

where, we used ∇(2) · u(1) = ∇(1) · u(1) = 0.
The sum of the mixed terms involving the rotational (Coriolis force) vanishes as a consequence of the anti-symmetry
of the cross product
D

u(2) · f ez × u(1)

E

r

D
E
D
E
+ u(1) · f ez × u(2) = f ez · u(2) × u(1) + u(1) × u(2) = 0.

(17)

The mixed terms involving the density fluctuation θ cannot be eliminated. Together with the contribution from the
single particle budgets of each of the particles, we obtain
D
E
D
E
2εχ − w(2) N θ(1) − w(1) N θ(2) = N ⟨∆r w∆r θ⟩r ,
r

(18)

r

In this work, we consider a forcing on the large scales. We thus assume it to vary little for sufficiently small r and
write Φ(2) ≈ Φ(1) . The forcing contribution from the mixed particle terms thus read
−⟨u(2) · Φ(1) ⟩ − ⟨u(1) · Φ(2) ⟩ ≈ −2εΦ

(19)

and cancel out the +2εΦ from the single particle terms.
To simplify the mixed viscous terms, we rewrite their sum


(2)

u



·ν ∇

(1)

2

(1)

u





(1)

+ u
r



·ν ∇

(2)

2

(2)

u



r


2 D
E
= ν ∇(1)
u(1) u(2) − 2Dν (r),
r

(20)

where the first term on the right hand side vanishes due to homogeneity and with the mixed dissipation term
Dν (r) ≡ ν

*

X
i,j

(1)

∂ui

(1)

∂xj

!

!+

(2)

∂ui

(2)

∂xj

.

(21)

r

Putting everything together, we obtain the two point budget for the kinetic pair energy


D (2)
E
Dt kin



r

= ⟨∆r u · ∆r a⟩r = −2εν − N ⟨∆r w∆r θ⟩r − 2Dν (r).

(22)

(2)

Similarly, we obtain the two particle budget for the potential pair energy Epot = θ2 /2:


D (2)
E
Dt pot



r

D
E
= ∆r θ · ∆r θ̇ = −2εκ + N ⟨∆r θ∆r w⟩ − 2Dκ (r).

(23)

with the mixed thermal diffusion term
Dκ (r) ≡ κ

*
+
X ∂θ(1) ∂θ(2)
j

∂xj ∂xj

r

.

(24)

5
Comment on Isotropy

We note that in the derivation above, we did not explicitly assume the system to be isotropic. In fact, the flows
we are considering here are largely anisotropic. In classical textbooks for the case of Navier-Stokes turbulence,
the velocity-pressure gradient correlations are normally eliminated under the assumption of isotropy [3, 4]. It was
then later demonstrated, that the derivation can alternatively be performed by assuming solely homogeneity and
incompressibility [5–7]. Furthermore, we note that in the derivation of the pair energy budget, we explicitly fixed
the orientation of the separation vector r. The energy budgets are thus valid when averaging for any fixed distance
and orientation, e.g. by prescribing the angle ϑ between the two particles and the z-axis, or when averaging over all
orientations as we do in the present work.
Comment on Stationarity

In the derivation above, we did not explicitly assume stationarity. Equations (10), (11), (22) and (23) should thus
also hold at any point in time in a non-stationary system, such as decaying turbulence. Note that then, quantities on
both sides of the equations are time-depended.
In our simulations, we have considered statistically steady flows. For this reason, we expect that all quantities on
the right hand side of eqs. (10), (11), (22) and (23) reach a statistical equilibrium. Assuming ergodicity, we compute
the Lagrangian averages over particle positions and time, as pointed out in the main manuscript.
In a stationary state, the one particle energy budgets simplify to


D
Ekin = 0 = ⟨u · a⟩ = εΦ − εχ − εν ,
(25)
Dt


D
Epot = 0 = ⟨θθ̇⟩ = εχ − εκ .
(26)
Dt
Hence, velocity and acceleration are correlated in such a way that their scalar product on average is zero.
The left-hand side of the two-particle energy, using the Lagrangian point of view, remains non-zero, even when the
flow is statistically steady, as the cross-correlation between velocity and acceleration is not vanishing. We stress that
in this case, the identity
⟨∆r u · ∆r a⟩r =

1
∇ · |∆r u|2 ∆r u r
2

(27)

establishes a connection with the Karman-Howarth-Monin in the Eulerian framework [2].

[1] R. A. Finkel and J. L. Bentley, Quad trees a data structure for retrieval on composite keys, Acta Informatica 4, 1 (1974).
[2] A. Sozza, G. Boffetta, P. Muratore-Ginanneschi, and S. Musacchio, Dimensional transition of energy cascades in stably
stratified forced thin fluid layers, Physics of Fluids 27, 035112 (2015).
[3] U. Frisch, Turbulence: The Legacy of A. N. Kolmogorov (Cambridge University Press, 1995).
[4] L. D. Landau and E. M. Lifshitz, Fluid Mechanics, 2nd ed., Course of Theoretical Physics, Vol. 6 (Butterworth-Heinemann,
Amsterdam Heidelberg, 1987).
[5] J. Mann, S. Ott, and J. S. Andersen, Experimental Study of Relative, Turbulent Diffusion, Report 87-550-2370-3 (Risø
National Laboratory, Roskilde, Denmark, 1999).
[6] R. J. Hill, Exact second-order structure-function relationships, Journal of Fluid Mechanics 468, 317 (2002).
[7] R. J. Hill, Opportunities for use of exact statistical equations, Journal of Turbulence 7, N43 (2006).

