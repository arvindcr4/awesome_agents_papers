arXiv:2412.10256v2 [math.CO] 15 Apr 2025

THE BBDVW CONJECTURE FOR KAZHDAN–LUSZTIG
POLYNOMIALS OF LOWER INTERVALS
GRANT T. BARKLEY AND CHRISTIAN GAETZ
Abstract. Blundell, Buesing, Davies, Veličković, and Williamson (BBDVW)
introduced the notion of a hypercube decomposition of an interval in Bruhat
order. They conjectured a recursive formula in terms of this structure which, if
shown for all intervals, would imply the Combinatorial Invariance Conjecture of
Lusztig and Dyer, for Kazhdan–Lusztig polynomials of the symmetric group. In
this article, we prove implications between the BBDVW Conjecture and several
other recurrences for hypercube decompositions, under varying hypotheses, which
have appeared in the recent literature. As an application, we prove the BBDVW
Conjecture for lower intervals [e, v], the first non-trivial class of intervals for which
it has been established.

1. Introduction
Kazhdan–Lusztig polynomials [KL79] have long been studied for their deep connections to Hecke algebras, the geometry of Schubert varieties, and representation
theory. Given two elements u and v of a Coxeter group W , the Kazhdan–Lusztig
polynomial Pu,v (q) ∈ Z[q] can be defined via a recurrence arising in the computation
of the canonical basis for the Hecke algebra associated to W ; see Section 2.1. When
W is the Weyl group of an algebraic group, the coefficients of Pu,v give the dimensions of cohomology groups of a stalk of the intersection cohomology complex on
a Schubert variety. Lusztig and Dyer independently made the following surprising
conjecture.
Conjecture 1.1 (Lusztig c. 1983; Dyer [Dye87]). If the Bruhat intervals [u, v] ⊂ W
and [u′ , v ′ ] ⊂ W are isomorphic posets, then Pu,v = Pu′ ,v′ .
This Combinatorial Invariance Conjecture and has received significant attention.
The conjecture has been proven in the case u = u′ = e are the identity element of
W [dC03, Bre04, BCM06, Del06], in the case where ℓ(u, v) is small and W is finite
e2 [BLP22]. It has also been shown in finite
[Inc06, Inc07], and for the group W = A
′
′
∼
simply laced type that, if [u, v] = [u , v ], then Pu,v and Pu′ ,v′ have the same linear
coefficient [Pat21]. It is known [BG24] that Conjecture 1.1 implies several related
conjectures in the parabolic setting.
Date: April 17, 2025.
2020 Mathematics Subject Classification. 05E14, 14M15.
GTB was partially supported by NSF grant DMS-2152991.
1

2

GRANT T. BARKLEY AND CHRISTIAN GAETZ

Recently, the case W = Sn (the most studied case) was treated by Blundell,
Buesing, Davies, Veličković, and Williamson [BBDVW]. Using techniques from
machine learning [DVB+ 21], they formulated a conjectural recurrence for the Pu,v ,
which uses only the poset structure of [u, v]. Their formula depends on a special
kind of order ideal I ⊂ [u, v] called a hypercube decomposition. Given a hypercube
decomposition I, they define two polynomials, Nu,v,I and Qu,v,I , which depend only
on the Kazhdan–Lusztig polynomials of smaller subintervals; see Section 2.3.
Conjecture 1.2 ([BBDVW]). Let I be any hypercube decomposition of [u, v] ⊂ Sn .
Then
(1)

q ℓ(u,v) Pu,v (q −1 ) − Pu,v (q) = Nu,v,I + Qu,v,I .

If true, this conjecture gives an algorithm for computing Pu,v given only the
poset underlying [u, v]: find a proper hypercube decomposition of [u, v], recursively
compute Nu,v,I and Qu,v,I , and use the known degree bound to compute Pu,v . In
[BBDVW] it was shown that this algorithm always terminates, since every interval of a symmetric group has a proper hypercube decomposition, the standard hypercube decomposition. Thus Conjecture 1.2 implies Conjecture 1.1. It was also
shown in [BBDVW], using techniques from geometric representation theory, that
the standard hypercube decomposition satisfies Conjecture 1.2. This is not enough
to deduce Combinatorial Invariance, because isomorphic Bruhat intervals may have
non-isomorphic standard hypercube decompositions.
We say that [u, v] is a lower interval if u = e is the identity element of Sn . Our
main theorem establishes Conjecture 1.2 for lower intervals.
Theorem 1.3. Let I be any hypercube decomposition of a lower interval [e, v] ⊂ Sn .
Then
q ℓ(u,v) Pu,v (q −1 ) − Pu,v (q) = Nu,v,I + Qu,v,I .
Although [BBDVW] has inspired a surge of work on hypercube decompositions
and the Combinatorial Invariance Conjecture (see [BG25, BM25, GW23, EMBG24]),
Theorem 1.3 is the first non-trivial class of intervals for which Conjecture 1.2 has
been proven. These other papers use hypercube decompositions to study the R- and
e
R-polynomials,
for which Conjecture 1.1 can equivalently be stated, but it has not
been clear heretofore how these results are related to the BBDVW Conjecture 1.2.
These other works on hypercube decompositions have also required the imposition of additional hypotheses on hypercube decompositions, beyond those originally
appearing in [BBDVW]. The formulas for relative R-polynomials in [GW23] are
considered only relative to special hypercube decompositions which generalize the
standard hypercube decomposition, but which are not combinatorial invariants of
an interval. In [BG25] we considered the combinatorial notion of a strong hypercube
decomposition (see Definition 3.1(i)) as well as property (E) (see Definition 3.1(iii)).

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

3

And in [BM25, EMBG24] the results require meet 1 and amazing hypercube decompositions, respectively. In Definition 3.1(ii) we introduce a new hypothesis, the
numerical criterion.
A hypercube decomposition I ⊂ [u, v] determines the hypercube maps θx : Ax →
[u, v], where Ax denotes the set of antichains of the poset Yx of elements in [u, v] \ I
differing from x ∈ I by a reflection (see Section 2.2). For any order ideal I ⊂
e
eu,v,I (see Definition 3.2). This is (a
[u, v] we introduce the relative R-polynomial
R
variable transform of) a generalization of the relative R-polynomial of Gurevich–
e
Wang [GW23]. We show that, given strongness and property (E), the relative Rpolynomial has a simple formula in terms of the hypercube map.
Theorem 1.4. Let [u, v] be an interval in the symmetric group. Let I be any
diamond-closed order ideal satisfying property (E) which has a strong hypercube
cluster at u. Then
X
eu,v,I =
q |Y | .
R
Y ∈Au
θu (Y )=v

In addition to proving the BBDVW formula, we will show that, under the same
hypotheses, a simpler version of the BBDVW formula holds for the R-polynomial.
The notation used in this Theorem is introduced in Section 2.
Theorem 1.5. If [u, v] is a simple interval, and I is any strong hypercube decomposition of [u, v], then
X
eθ (Y ),v = 0.
(−q)|Y | R
u
Y ∈Au

If, moreover, I satisfies the numerical criterion, then (1) holds.

We conjecture that in fact the same formula holds without the assumptions of simplicity or strongness, given the numerical criterion; this would imply the Combinatorial Invariance Conjecture.
Conjecture 1.6. Let I be a hypercube decomposition of [u, v] satisfying the numerical criterion at u, then:
X
eθ (Y ),v = 0.
(−q)|Y | R
u
Y ∈Au

We prove that, at least for lower intervals, some of these hypotheses are automatically satisfied.

Theorem 1.7. Let I be any hypercube decomposition of a lower interval [e, v] ⊂ Sn .
Then I has property (E) and the hypercube cluster at e is strong and satisfies the
numerical criterion.
1The conventions of [BM25] use upper hypercube decompositions which are poset-dual to the
(lower) hypercube decompositions used here and in [BBDVW]. Therefore what is called a join
hypercube decomposition in [BM25] is most naturally called a meet hypercube decomposition here.

4

GRANT T. BARKLEY AND CHRISTIAN GAETZ

e
We also pose the following conjecture, which involves the formula for R-polynomials
introduced in [BG25]. It, too, would imply the Combinatorial Invariance Conjecture.
Conjecture 1.8. Let I be a hypercube decomposition of [u, v] satisfying the numerical criterion, then
X X
eu,v =
eu,x .
R
q |Y | R
x∈I Y ∈Ax
θx (Y )=v

Outline. In Section 2 we give preliminaries on Kazhdan–Lusztig polynomials, hypercube decompositions, and the polynomials appearing the BBDVW Conjecture 1.2.
In Section 3.1, we reformulate the BBDVW Conjecture in terms of R-polynomials.
In Section 3.2 we introduce the hypotheses of strongness, the numerical criterion,
and property (E) for hypercube clusters. In Section 3.3, we introduce the relative
e
eu,v,I for order ideals I ⊂ [u, v] and prove Theorem 1.4, showing
R-polynomials
R
that when I admits a hypercube cluster satisfying strongness and property (E),
e
the relative R-polynomials
can be computed in terms of the hypercube map θ. In
Section 3.4 we show that if I additionally satisfies the numerical criterion, then the
reformulated BBDVW Conjecture holds for I. And in Section 3.5 we show that
hypercube decompositions of simple intervals always satisfy property (E) and use
this to prove Theorem 1.5.
In Section 4 we study structural properties of the hypercube decompositions of
lower intervals in order to prove Theorem 1.7. Together with the results of Section 3,
this implies Theorem 1.3, resolving the BBDVW Conjecture for lower intervals.
2. Preliminaries
We refer the reader to [BB05] for background on Coxeter groups.
2.1. Kazhdan–Lusztig polynomials. Let W be a Coxeter group with simple
generating set S and length function ℓ. The reflections of W are the conjugates
of elements of S. The Bruhat graph of W is the directed graph Γ with vertex set
W and edges x → y whenever yx−1 is a reflection and ℓ(x) < ℓ(y). We sometimes
view Γ as an edge-labeled graph, where an edge x → y is labeled by the reflection
yx−1 . The Bruhat order is the partial order on W so that x ≤ y if and only if there
is a path from x to y in the Bruhat graph. We write Γ(u, v) for the the induced
subgraph of Γ on the elements of [u, v].
Theorem 2.1 (Kazhdan–Lusztig [KL79]). There is a unique family of polynomials
(Ru,v )u,v∈W so that for any u, v ∈ W , the following hold:
• If u 6≤ v, then Ru,v = 0.
• If u = v, then Ru,v = 1.
• If u < v, and s ∈ S is such that sv < v, then
(
Rsu,sv
if su < u
Ru,v =
.
(q − 1)Ru,sv + qRsu,sv if su > u

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

5

eu,v so
From the recurrence, one can deduce that there is a unique polynomial R
eu,v (q 1/2 − q −1/2 ). Matthew Dyer introduced a description
that Ru,v (q) = q ℓ(u,v) R
e
of R-polynomials
using only the edge-labeled graph Γ(u, v). His description uses
reflection orders; for simplicity, we define these only for W = Sn . In this case,
reflections coincide with the transpositions.
Definition 2.2 ([Dye87]). A reflection order for Sn is a total ordering ≺ on the set
of reflections so that for all 1 ≤ a < b < c ≤ n, either
(a b) ≺ (a c) ≺ (b c)

or

(b c) ≺ (a c) ≺ (a b).

t

t

We that say a path
t

1
2
k
x0 −
→
x1 −
→
· · · −→
xk
in Γ is increasing (with respect to ≺) if t1 ≺ t2 ≺ · · · ≺ tk . We denote the set of
increasing paths from u to v by Γ≺ (u, v), and the length k of such a path γ by ℓ(γ).
We say a path γ is increasing at xi if ti ≺ ti+1 and we say γ is increasing from xi to
xj if ti+1 ≺ · · · ≺ tj . We similarly define decreasing.

Theorem 2.3 (Dyer [Dye87]). For any u, v ∈ W , we have that
X
eu,v (q) =
R
q ℓ(γ) .
γ∈Γ≺ (u,v)

In particular, the sum
order ≺.

P

γ∈Γ≺ (u,v) q

ℓ(γ) is independent of the choice of reflection

Theorem 2.4 (Kazhdan–Lusztig [KL79]). There is a unique family of polynomials
(Pu,v )u,v∈W so that for any u, v ∈ W , the following hold:
• If u 6≤ v, then Pu,v = 0.
• If u = v, then Pu,v = 1.
• If u < v, then deg Pu,v < 12 ℓ(u, v), and
X
q ℓ(u,v) Pu,v (q −1 ) − Pu,v (q) =
Ru,x Px,v .
x∈(u,v]

2.2. Hypercube decompositions. From now on, we let W = Sn be a symmetric
group, with standard choice of Coxeter generators si = (i i + 1) for i = 1, . . . , n − 1.
The definitions in this section were introduced in [BBDVW] and [BG25]; see those
references for more information.
Definition 2.5. Let Hn denote the hypercube graph, which is the Hasse diagram
of a Boolean lattice with n elements, viewed as a directed graph. An n-hypercube
in Γ(u, v) is a subgraph isomorphic to Hn . A 2-hypercube in Γ(u, v) is called a
diamond. A subset I of [u, v] is diamond-closed if, whenever I contains three vertices
of a diamond H in Γ(u, v), then I contains the fourth vertex of H.
If y1 , . . . , yn are the endpoints of the edges outgoing from the bottom vertex of
an n-hypercube H in Γ(u, v), then we say that H is spanned by {y1 , . . . , yn }.

6

GRANT T. BARKLEY AND CHRISTIAN GAETZ

Definition 2.6. Let I be a subset of [u, v] and let x ∈ I. We define the sets
Yx := {y ∈ [u, v] \ I | x → y}
Ax := {Y ⊆ Yx | Y is an antichain}.
We say there is a hypercube cluster at x (relative to I) if, for every Y ∈ Ax , there
is a unique hypercube in Γ(u, v) spanned by Y and with bottom vertex x. In this
case, we define a function θx : Ax → Γ(u, v), the hypercube map, which sends an
antichain Y to the top vertex of the unique hypercube spanned by Y .
If there is a hypercube cluster at x, then we extend the domain of θx to include
arbitrary subsets Y ⊂ Yx by defining θx (Y ) to be the top of the unique hypercube
spanned by the maximal elements of Y .
Definition 2.7 ([BBDVW]). A hypercube decomposition of [u, v] is a subset I of
[u, v] such that the following hold:
(HD1) I = [u, z] for some z ∈ [u, v], and
(HD2) I is diamond-closed in [u, v], and
(HD3) For every x ∈ I, there is a hypercube cluster at x relative to I.
2.3. BBDVW polynomials. Let I be a hypercube decomposition of [u, v]. In this
section we will introduce the polynomials Nu,v,I and Qu,v,I used in Theorem 1.3.
Note that our Nu,v,I is (q − 1) times the polynomial Iu,v,I from [BBDVW], and our
Qu,v,I is (q − 1) times the polynomial Qu,v,I from [BBDVW].
2.3.1. Nu,v,I . We recall the definition of Nu,v,I from [BBDVW]. In Section 3.1,
we will show Nu,v,I simplifies greatly when expressed using R-polynomials. We will
exclusively use the simplified version in the proofs, so the auxiliary definitions in this
subsection may be skipped by the reader uninterested in the comparison between
the two definitions of Nu,v,I .
Let MI denote the free Z[q]-module with basis {δx | x ∈ I \{u}}. There is another
basis for MI , with elements by for y ∈ I \ {u}, defined by
X
by =
Pu,x · δx .
x∈(u,y]

Define
ru,v,I :=

X

Px,v · δx

x∈I\{u}

and expand this element of MI in the basis {by }y∈I\{u} to get some family of coefficients (γy )y∈I\{u} :
X
ru,v,I =
γ y · by .
y∈I\{u}

Using these coefficients, define
X
Nu,v,I :=
γy (q ℓ(u,y) Pu,y (q −1 ) − Pu,y (q)).
y∈I\{u}

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

7

2.3.2. Qu,v,I . Recall that I is a hypercube decomposition of [u, v], so there is a
hypercube map θu sending subsets of Yu to elements of [u, v]. Define
X
Qu,v,I := − q ℓ(u,v)
(2)
(q −1 − 1)|Y | Pθu (Y ),v (q −1 )
=−

X

∅6=Y ⊆Yu

q ℓ(u,θu (Y )) (q −1 − 1)|Y |

∅6=Y ⊆Yu

X

Rθu (Y ),y Py,v .

y∈[θu (Y ),v]

3. An alternating sum formula
3.1. New expressions for the BBDVW polynomials. We now show how to
rewrite Nu,v,I in terms of R-polynomials. We note that, by definition, (γy )y∈I\{u} is
the unique family of polynomials so that, for all x ∈ I \ {u},
X
Px,v =
γy Px,y .
y∈I

Now we rewrite, using Theorem 2.4:
X
Nu,v,I =
γy (q ℓ(u,y) Pu,y (q −1 ) − Pu,y )
y∈I\{u}

=

X

y∈I\{u}

=

X

x∈I\{u}

=

X

γy

X

Ru,x Px,y

x∈(u,y]

Ru,x

X

γy Px,y

y∈I\{u}

Ru,x Px,v .

x∈I\{u}

P
So we may alternatively take Nu,v,I :=
x∈I\{u} Ru,x Px,v as the definition of
Nu,v,I . This definition makes sense when I is any order ideal of [u, v].
Let Λ(Y ) denote the order ideal of Yu generated by Y (i.e. the set of elements of Yu
weakly below some element of Y in Bruhat order). By partitioning the summation
in (2) into sums over those subsets of Yu having the same antichain of maximal
elements (and hence the same image under θu ), we find an expression for Qu,v,I as
a sum over antichains:
X
q ℓ(u,v)−|Λ(Y )| (−1)|Y |+1 (q − 1)|Y | Pθu (Y ),v (q −1 )
Qu,v,I =
∅6=Y ∈Au

=

X

∅6=Y ∈Au

q ℓ(u,θu (Y ))−|Λ(Y )| (−1)|Y |+1 (q − 1)|Y |

X

Rθu (Y ),y Py,v .

y∈[θu (Y ),v]

We now give an equivalent form of Conjecture 1.2 that will be the form we prove.
As originally stated, Conjecture 1.2 asserts
q ℓ(u,v) Pu,v (q −1 ) − Pu,v = Nu,v,I + Qu,v,I .

8

GRANT T. BARKLEY AND CHRISTIAN GAETZ

Expanding both sides, this is
X
X
X
Ru,x Px,v =
Ru,x Px,v −
x∈(u,v]

q ℓ(u,θu (Y )) (q −1 −1)|Y |

∅6=Y ⊆Yu

x∈I\{u}

We can rewrite this equality as
X
q ℓ(u,θu (Y )) (q −1 − 1)|Y |
Y ⊆Yu

X

Rθu (Y ),y Py,v .

y∈[θu (Y ),v]

X

Rθu (Y ),y Py,v = 0.

y∈[u,v]\I

In terms of antichains, this is
X
(−1)|Y | q ℓ(u,θu (Y ))−|Λ(Y )| (q − 1)|Y |
(BBDVW)
Y ∈Au

X

Rθu (Y ),y Py,v = 0.

y∈[u,v]\I

We refer to (BBDVW) as the BBDVW formula; this is the equality we will prove
in what follows.
3.2. Strongness, the numerical criterion, and property (E). We now define
several additional properties that a hypercube decomposition may satisfy.
Definition 3.1. Suppose that the interval [u, v] has a hypercube cluster at x, relative to an order ideal I, with hypercube map θx : Ax → Γ(u, v). We say that this
hypercube cluster:
(i) is strong [BG25] if for any Y1 , Y2 ∈ Ax with |Y1 | = |Y2 | = |Y1 ∩ Y2 | + 1, if there
is a subgraph of Γ(u, v) of the form
w
θx (Y1 )

θx (Y2 ),
θx (Y1 ∩ Y2 )

then Y1 ∪ Y2 is an antichain and θx (Y1 ∪ Y2 ) = w;
(ii) satisfies the numerical criterion if for all Y ∈ Ax we have
(3)

ℓ(x, θx (Y )) + |Y |
= |Λ(Y )|,
2

where Λ(Y ) denotes the order ideal of the poset (Yx , ≤) generated by Y ; and
(iii) satisfies property (E) [BG25] if there exists a reflection order ≺ so that if
t1
t2
x1 −
→ x2 and x3 −
→ y, with x1 , x2 , x3 ∈ I ∩ [x, v] and y ∈ [x, v] \ I, then
t1 ≺ t2 .
We say that a hypercube decomposition I of [u, v] has one of these properties if the
hypercube cluster at x does, for all x ∈ I.

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

9

e
3.3. The relative R-polynomial.
Let I be a nonempty order ideal of [u, v].

e
Definition 3.2. The relative R-polynomial
of [u, v] with respect to I is
X
eu,x (−q)R
ex,v (q).
eu,v,I :=
R
R
x∈I

ex,y,I for R
ex,y,I∩[x,y].
When x, y ∈ [u, v], we also write R

For a path γ : x0 → · · · → xk in Γ(u, v), we let prevγ (xi ) = xi−1 for i = 1, . . . , k
and nextγ (xi ) = xi+1 for i = 0, . . . , k − 1. For K ⊂ [u, v], we write γ|K for the
restriction of γ to K.
Proposition 3.3. If I = [u, v], then we have
(
eu,v,I = 1 if u = v
(4)
R
0 otherwise.

Otherwise, let I be a nonempty proper order ideal in [u, v] and let ≺ be any
reflection order. Then
X
eu,v,I =
R
(−1)ℓ(γ|I ) q ℓ(γ) ,
γ∈ΓI≺ (u,v)

where ΓI≺ (u, v) is the set of paths from u to v which are ≺-decreasing from u to
next(x) and ≺-increasing from x to v, where x is the last vertex on γ|I .
Proof. By Theorem 2.3 and Definition 3.2,
X
eu,v,I =
R
(−1)ℓ(γ1 ) q ℓ(γ1 )+ℓ(γ2 ) ,
(γ1 ,γ2 )

where the sum ranges over pairs (γ1 , γ2 ), with γ1 a decreasing path from u to some
point x ∈ I and γ2 an increasing path from x to v. We can concatenate the pair
(γ1 , γ2 ) to form a single path γ from u to v having a marked point x ∈ I. There is a
eu,v,I which replaces the marked
sign-reversing partial involution ι on the terms of R
point x with prevγ (x) (resp. nextγ (x)) if γ is increasing (resp. decreasing) at x. For
the purpose of this involution (and the others in this section), we declare every path
to be decreasing at u and increasing at v. The involution ι is well defined unless x
is the last vertex on γ|I and either x = u = v or the path is decreasing at x. Hence
eu,v,I counts paths γ from u to v so
by canceling terms paired by ι, we see that R
that if x is the last vertex on γ|I , then the path is decreasing from u to next(x) and
increasing from x to v, each with weight (−1)ℓ(γ|I ) q ℓ(γ) .

e
Remark 3.4. Our relative R-polynomial
is a generalization of that of Gurevich and
Wang by [GW23, Proposition 3.12]. They give an interpretation of their relative
e
R-polynomial
in terms of Hecke algebras; it would be interesting to see if there is a
similar description in our context.

10

GRANT T. BARKLEY AND CHRISTIAN GAETZ

321

321
231

312

231

312

213

132

ι

⇐
⇒
x = 213

132

prev(x) = 123

123

Figure 1. An example of the involution ι from the proof of Proposition 3.3. The order ideal I is shown in blue. The reflection order is
(1 2) ≺ (1 3) ≺ (2 3). The path γ is shown with red arrows, and the
marked point is highlighted in pink. In this example, γ is increasing
at 213 and decreasing at 123, so ι swaps the marked point between
those two vertices.
e
We show in Lemmas 3.5 and 3.6 that the relative R-polynomial
satisfies two
identities related to Conjectures 1.6 and 1.8. The first of these is a generalization
of [GW23, Proposition 3.12].
Lemma 3.5. Let I be a nonempty order ideal of [u, v]. Then
X
eu,x R
ex,v,I .
eu,v =
R
R
x∈I

Proof. The right hand side counts paths γ from u to v with marked points x1 , x2 ∈ I
so that x1 ≤ x2 are on the path γ, x2 is the last point of γ in I, and γ is increasing
from u to x1 , decreasing from x1 to next(x2 ), and increasing from x2 to v. The
weight of γ is (−1)ℓ(γ1 ) q ℓ(γ) , where γ1 is the subpath from x1 to x2 . There is a
sign-reversing involution which replaces the marked point x1 with either prev(x1 )
or next(x1 ) depending on whether γ is decreasing or increasing at x1 , respectively.
This is well-defined unless γ is increasing at x1 and x1 = x2 . Hence the terms left
uncancelled by the involution are simply the increasing paths from u to v, with the
marked points x1 and x2 both coinciding with the last point of γ in I. These paths
eu,v .
are counted with weight q ℓ(γ) , so the remaining terms sum to exactly R

Lemma 3.6. Let I be a nonempty order ideal of [u, v]. Then
X
eu,y,I (−q)R
ey,v (q) = 0.
R
y∈[u,v]

P

Proof. First we note that
enough to show that
X

e

e

e

y∈I Ru,y,I (−q)Ry,v (q) = Ru,v (q) by (4).

y∈[u,v]\I

eu,y,I (−q)R
ey,v (q) = −R
eu,v (q).
R

Hence it is

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

11

The left hand side of this counts paths γ from u to v with marked points x, y so
that x is the last point of γ in I, y is in [u, v] \ I, and γ is decreasing from u
to next(x), increasing from x to y, and decreasing from y to v. The weight of
such a path is (−1)ℓ(γ2 ) q ℓ(γ) , where γ2 is the subpath from x to y. There is a
sign-reversing involution which replaces the marked point y with either prev(y) or
next(y), depending on whether γ is decreasing at y or increasing at y, respectively.
This is well-defined unless γ is decreasing at y and y = next(x). Hence the remaining
eu,v .
terms count decreasing paths γ with weight −q ℓ(γ) , so sum to −R


e
As a consequence of either of these lemmas, the R-polynomial
of an interval can be
e
computed in terms of the R-polynomials of strictly smaller intervals and the relative
e
R-polynomials
with respect to any proper non-empty order ideal. In particular, if
e
every interval has a combinatorially defined order ideal for which the relative Rpolynomial can be computed combinatorially, then combinatorial invariance holds.
We now restate and prove Theorem 1.4.
Theorem 3.7. Let I be a diamond-closed order ideal of [u, v]. Assume there is a
hypercube cluster at x ∈ I which is strong and satisfies property (E). Then
X
ex,v,I =
R
q |Y | .
Y ∈Ax
θx (Y )=v

ex,v,I counts paths γ from x to v which are decreasing at every
Proof. Recall that R
point in I and increasing at every point in [u, v] \ I. Since the hypercube cluster at x
satisfies property (E), there is a reflection order ≺ so that the edge labels of I in [x, v]
are ordered before the edge labels of edges leaving I in [x, v]. Using this reflection
order, if x′ is the last vertex of γ in I and x′ 6= x, then γ is increasing at x′ . Thus no
ex,v,I use any vertex of I other than x. In other words, with such
paths counted by R
ex,v,I counts increasing paths from x to v so that x is the only
a reflection order, R
element from I on the path. Now [BG25, Lemmas 3.12 and 3.15] together show that
such paths are in bijection with elements Y ∈ Ax so that θx (Y ) = v. Furthermore,
ex,v,I = P Y ∈Ax q |Y | .

the length of the path coincides with |Y |. Hence R
θx (Y )=v

e
3.4. From relative R-polynomials
to the BBDVW formula.

Lemma 3.8. Assume that I is a diamond-closed order ideal of [u, v] with a hypercube
cluster at u that is strong and has property (E). Then for any y ∈ [u, v] \ I,
X
eθ (Y ),y = 0.
(−1)|Y | q |Y | R
(5)
u
Y ∈Au

If, furthermore, the hypercube cluster satisfies the numerical criterion, then for any
y ∈ [u, v] \ I,
X
(−1)|Y | q ℓ(u,θu (Y ))−|Λ(Y )| (q − 1)|Y | Rθu (Y ),y = 0.
(6)
Y ∈Au

12

GRANT T. BARKLEY AND CHRISTIAN GAETZ

Proof. Lemma 3.6 shows that
X

y∈[u,v]

eu,y,I (−q)R
ey,v (q) = 0.
R

Hence combining this with Theorem 3.7 proves (5). By substituting q 1/2 − q −1/2 in
the left hand side of (5) and multiplying by q ℓ(u,y)/2 , we find that
X
(−1)|Y | q (ℓ(u,θu (Y ))−|Y |)/2 (q − 1)|Y | Rθu (Y ),y = 0.
Y ∈Au

The numerical criterion implies that q (ℓ(u,θu (Y ))−|Y |)/2 = q ℓ(u,θu (Y ))−|Λ(Y )| , which
proves (6).

Corollary 3.9. If I is a diamond-closed order ideal of [u, v] with a hypercube cluster
at u which is strong, satisfies the numerical criterion, and has property (E), then
(BBDVW) holds for I.
Proof. Exchanging the order of summation in (BBDVW) the assertion becomes:
!
X
X
|Y | ℓ(u,θu (Y ))−|Λ(Y )|
|Y |
(−1) q
(q − 1) Rθu (Y ),y Py,v = 0.
y∈[u,v]\I

Y ∈Au

By Lemma 3.8, the inner sum vanishes for all y ∈ [u, v] \ I.



Hence to prove Theorem 1.3, it is enough to prove Theorem 1.7, so that Corollary 3.9 can be applied to any hypercube decomposition of a lower interval.
3.5. Property (E). The remainder of the paper is dedicated to establishing Definition 3.1(i-iii) for hypercube decompositions of lower intervals. There is in fact a
larger class of intervals already known to satisfy property (E), introduced in [BG25].
Definition 3.10. The interval [u, v] is simple if the roots ei − ej corresponding to
the cover relations u ⋖ (i j)u ≤ v are linearly independent.
The following was shown in the proof of [BG25, Corollary 4.6].
Proposition 3.11. If [u, v] is simple and I is a principal diamond-closed order
ideal, then I satisfies property (E).
Any lower interval is simple. Hence we deduce from Proposition 3.11:
Corollary 3.12. If [e, v] is a lower interval and I is a hypercube decomposition of
[e, v], then I satisfies property (E).
Theorem 3.7 and Proposition 3.11 imply another corollary of independent intere
est, which shows that relative R-polynomials
of simple intervals can be computed
combinatorially. (Note, though, that simple intervals cannot be recognized combinatorially.)

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

13

Corollary 3.13. If [u, v] is a simple interval and I is a principal diamond-closed
order ideal with a strong hypercube cluster at x ∈ I, then
X
ex,v,I =
q |Y | .
R
Y ∈Ax
θx (Y )=v

Proposition 3.11 and Lemma 3.8 together imply a strengthening of Theorem 1.5.
Corollary 3.14. If [u, v] is a simple interval, and I is a principal diamond-closed
order ideal of [u, v] with a strong hypercube cluster at u, then
X
eθ (Y ),v = 0.
(−q)|Y | R
u
Y ∈Au

4. Hypercube decompositions of lower intervals

We now prove Theorem 1.7, which we restate here.
Theorem 4.1. Let v ∈ Sn and let I = [e, z] be any hypercube decomposition of
[e, v]. Then I has property (E) and the hypercube cluster at e, relative to I:
(i) is strong, and
(ii) satisfies the numerical criterion.
4.1. Blocks of hypercube decompositions. In order to prove Theorem 4.1, we
will study the structure of Ae , relative to a hypercube decomposition I of [e, v].
We will see in this section that I induces a partition of [n] into blocks and see in
Section 4.2 that the structure of Ae is controlled by certain combinatorial diagrams,
decorating the blocks, that we call caravans. Our starting point is the following
fact:
Proposition 4.2. Let v ∈ W = Sn and let I be any diamond-closed order ideal in
[e, v]. Then I = [e, v] ∩ WJ for some parabolic subgroup WJ ⊂ W . Moreover, I is a
principal order ideal.
Proof. Lower intervals are in particular simple intervals (see Definition 3.10). Thus,
by [BG25, Prop. 4.4], I = [e, v] ∩ W ′ where W ′ is the reflection subgroup of W
generated by the set J of atoms of I. These atoms are all simple reflections, and
so W ′ = WJ is in fact a standard parabolic subgroup. Then [BFL99, Thm. 2.2]
implies that [e, v] ∩ WJ has a unique maximal element under Bruhat order, so I is
principal.

In particular, we have:
Corollary 4.3. Let v ∈ W = Sn . Then any hypercube decomposition of [e, v] is of
the form I = [e, v] ∩ WJ , where J is the set of atoms of I.
Remark 4.4. Although [e, v] ∩ WJ is a principal diamond-closed order ideal for any
choice of v and J, it is not always a hypercube decomposition of [e, v].

14

GRANT T. BARKLEY AND CHRISTIAN GAETZ

The parabolic subgroups of Sn are of the form SB1 ×· · ·×SBb , where B1 ⊔· · ·⊔Bb =
[n], each block Ba is a nonempty set of consecutive integers, and where SB denotes
the group of permutations of the block B. We assume that we have numbered the
blocks so that the elements of Ba are less than those of Ba′ for a < a′ . Note that
some blocks may be singletons.
Now fix any hypercube decomposition I of [e, v] and let B1 , . . . , Bb be the blocks
associated to the parabolic subgroup WJ , with J the atoms of I. Since I = [e, v]∩WJ
by Corollary 4.3, we note:
Observation 4.5. The elements of Ye are precisely the reflections (i j) ≤ v such that
i and j belong to different blocks.
We make the convention of writing all reflections as (i j) with i < j. We now
further analyze the structure of Ye .
Lemma 4.6. We have (i j) ≤ (k l) in Bruhat order if and only if k ≤ i < j ≤ l.
Proof. The reverse implication follows immediately from the Subword Property for
Bruhat order (see, e.g. [BB05, Thm. 2.2.2]) after noting that the reduced word
si si+1 · · · sj−1 sj sj−1 · · · si+1 si for (i j) is a subword of the analogously constructed
reduced word for (k ℓ). The forwards implication follows from the Tableau Criterion
[BB05, Theorem 2.6.3].

Lemma 4.7. If (i j) ∈ Ye , then for all k with i < k < j exactly one of (i k) and
(k j) lies in Ye .
Proof. By Lemma 4.6, (ik) and (kj) are incomparable in Bruhat order, and both are
less than (i j). It cannot be that both lie in Ye , since this would violate uniqueness
in the hypercube cluster at e: we would have diamonds e ⇒ (i k), (k j) ⇒ (i j k) and
e ⇒ (i k), (k j) ⇒ (i k j) since (i k j), (i j k) ≤ (i j). On the other hand, it cannot be
that both lie in I, since this would imply that (i j) ∈ I by diamond-closure.

Corollary 4.8. If (i j) ∈ Ye , then i and j lie in consecutive blocks.
Proof. If not, then ∃k with i < k < j such that k lies in a different block than both
i and j. By Observation 4.5 and Lemma 4.6, we see that both (i k) and (k j) lie in
Ye , but this contradicts Lemma 4.7.

Lemma 4.9. If (i j) ∈ Ye , then i + 1, . . . , j − 1 lie in the same block.
Proof. Suppose to the contrary that some i′ , j ′ with i < i′ < j ′ < j lie in different
blocks. Since (i j) ∈ Ye , we have in particular that (i j) ≤ v, and so (i′ j ′ ) ≤ v by
Lemma 4.6. Moreover, (i′ j ′ ) ∈ Ye by Observation 4.5.
Now, since I is an order ideal and since (i′ j ′ ) is less than (i j ′ ) and (i′ j) and
both of these are less than (i j) by Lemma 4.6, it must be that (i j ′ ), (i′ j) ∈ Ye . By
Lemma 4.7, this implies that (i i′ ), (j ′ j) ∈ I, since (i′ j ′ ) ∈ Ye . By diamond-closure,
we see that the product (i i′ )(j ′ j) also lies in I. There are four elements y ≤ (i j)
with (i i′ )(j ′ j) → y in Γ(e, v), namely (i i′ j j ′ ), (i j ′ j i′ ), (i j j ′ i′ ), and (i i′ j ′ j), which

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

1

2

3

4

5

15

6

Figure 2. An example of a caravan with four blocks (shaded in red)
and two camels. All edges are implicitly directed towards the right.
are incomparable. All four of these elements are greater than (i′ j ′ ) and therefore do
not lie in I and so form an antichain in A(i i′ )(j ′ j) . Thus these four elements span
a 4-hypercube H in Γ(e, v); furthermore, H is contained in the reflection subgroup
W ′ = S{i,i′ ,j ′ ,j} by [Dye91, Lemma 3.1]. But one can easily check that the Bruhat
graph of W ′ (which by [Dye91] can be identified with Γ(e, (i j)(i′ j ′ ))) contains only
one 4-hypercube H′ and that H′ has bottom vertex (i′ j ′ ) rather than (i i′ )(j ′ j), a
contradiction.

Corollary 4.10. Suppose (i j) ∈ Ye and let Ba and Ba+1 be the blocks containing
i and j, respectively. Then i = max(Ba ) or j = min(Ba+1 ).
Proof. If not, then i + 1 ∈ Ba while j − 1 ∈ Ba+1 , contradicting Lemma 4.9.



4.2. Antichains, camels, and caravans. We now extract the implications of the
results of Section 4.1 for the set of antichains Ae in (Ye , ≤). As before, we let I be
a fixed hypercube decomposition of a lower interval [e, v] ⊂ W = Sn .
We can construct a directed graph called the caravan Car(Y ) of an antichain
Y ∈ Ae , having vertices [n] drawn in increasing order from left to right, grouped
according to the blocks induced by I, and with an arc from i to j > i whenever
(i j) ∈ Ye . Lemma 4.6 guarantees that the arcs do not nest. Corollaries 4.8 and 4.10
imply that each arc connects vertices in consecutive blocks and begins at the maximal vertex of its left block or ends at the minimal vertex of its right block (see
Example 1). We call the non-singleton weakly connected components of a caravan
camels. Let  denote the total order on the set of camels according to their minimal
vertices.
Example 1. Consider the interval [e, 361245] with z = 214356 defining a hypercube
decomposition I = [e, z]. Then
Y = {(1, 3), (2, 4), (4, 5), (5, 6)}
is an antichain in Ae . The caravan Car(Y ) is depicted in Figure 2.
Proposition 4.11. Let v ∈ W = Sn and let I be any hypercube decomposition of
[e, v], and let Y ∈ Ae . Then the caravan Car(Y ) has the following properties:
(1) Every vertex of Car(Y ) has in-degree and out-degree each at most 1.
(2) Suppose (i j), (i′ j ′ ) ∈ Y have i < i′ < j < j ′ , then j = min(Ba+1 ) and
i′ = max(Ba ) for some a.

16

GRANT T. BARKLEY AND CHRISTIAN GAETZ

(3) Let C ≺ C ′ be camels of Car(Y ). Then either max(C) < min(C ′ ) or
max(C) = min(C ′ ) + 1, in which case max(C) and min(C ′ ) are the minimal and maximal vertices in their blocks, respectively.
Proof. Since Y is an antichain, no vertex can have in-degree greater than 1, since
the two arcs would necessarily nest, and therefore by Lemma 4.6 the two reflections
would be comparable; the same is true for out-degree. This proves (1).
Now suppose (i j), (i′ j ′ ) ∈ Y with i < i′ < j < j ′ . By Corollary 4.10, we have
i = max(Ba ) or j = min(Ba+1 ) for some a. Since j − i ≥ 2, we cannot have both. So
suppose first that i = max(Ba ). In this case, since arcs connect consecutive blocks,
we have i′ , j ∈ Ba+1 and j ′ ∈ Ba+2 . Thus i′ is not the maximum element of its block,
so we must have j ′ = min(Ba+2 ) by Corollary 4.10. Now, since (i j), (i′ j ′ ) ∈ Y , we
must have (i j)(i′ j ′ ) ≤ v by the hypercube condition, since this is the top of the
unique diamond in Γ containing e, (i j), and (i′ j ′ ). By Observation 4.5, we have
(i′ j) ∈ I, since (i′ j) < (i j) < v but i′ and j lie in the same block. By Lemma 4.7
this implies that (i i′ ), (j j ′ ) ∈ Ye .
There are edges (i′ j) → y for each y ∈ Y ′ = {(i′ ji), (i′ ij), (i′ j ′ j), (i′ jj ′ )}. Furthermore, these four elements are incomparable, each element y lies below (ij)(i′ j ′ ), and
hence in [e, v], and each lies outside of I, since I is an order ideal and y ≥ (i i′ ) 6∈ I
or y ≥ (j j ′ ) 6∈ I. Thus there must be a 4-hypercube spanned by these elements.
As argued in the proof of Lemma 4.9, this hypercube must be contained in the
subgraph of Γ(e, v) on Si,i′ ,j,j ′ ∼
= S4 . An easy check shows that there is a unique
4-hypercube in S4 , and that the top of that hypercube is (i j ′ ). Hence we must have
θ(i′ j) (Y ′ ) = (i j ′ ), so in particular, (i j ′ ) ∈ Ye . But this contradicts Lemma 4.7,
since (i i′ ), (i′ j ′ ) ∈ Ye . Thus it must instead be the case that j = min(Ba+1 ), with
i ∈ Ba . This implies that i′ ∈ Ba and so j ′ ∈ Ba+1 and j ′ is not minimal in its
block. Another application of Corollary 4.10 implies that i′ = max(Ba ), so we have
proven (2).
Now suppose that C ≺ C ′ are camels of Car(Y ) with max(C) > min(C ′ ) =: i′ . Let
′
y = (i′ j ′ ) be the leftmost arc of C ′ . By hypothesis, we have min(C) < i′ < max(C),
so i < i′ < j for some arc (i j) of C. Since Y is an antichain, we must have
j ′ > j, otherwise by Lemma 4.6 we would have y ′ < (i j). By part (2) we must
have j = min(Ba+1 ) and i′ = max(Ba ) for some a. Suppose that (i j) is not the
rightmost arc of C, so there is some (j k) in C. By Corollary 4.8, we have k ∈ Ba+2
and hence i′ < j < j ′ < k. But now part (2) implies that j ′ = min(Ba+1 ), so
j = j ′ , a contradiction. Thus (i j) is the rightmost arc of C and so j = max(C) =
min(Ba+1 ) = max(Ba ) + 1 = i′ + 1 = min(C ′ ) + 1, proving (3).

Proposition 4.11(3) tells us that the supports [min(C), max(C)] for different camels
C are almost disjoint: the only possible overlaps are at the ends of the camels, where
they might overlap on two elements. This means that the subsets of Y ∈ Ae corresponding to different camels can almost be treated independently, with a small
adjustment for the possible overlap. We say that the pair y and y ′ of arcs of C and
C ′ as in Proposition 4.11(2) are crossing. All other pairs of arcs are noncrossing.

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

17

We similarly say that camels C and C ′ are crossing or noncrossing according to
whether they contain such a pair of arcs. We let cr(Y ) denote the number of pairs
of crossing camels in Car(Y ); note that, by Proposition 4.11, any pair of crossing
camels must be consecutive in the total order ≺.
Proposition 4.12. Let v ∈ W = Sn and let I be any hypercube decomposition of
[e, v].
(1) For y = (i j) ∈ Ye , we have |Λ({y})| = j − i.
(2) Let y = (ij) and y ′ = (i′ j ′ ) be incomparable elements of Ye , with i < i′ . Then
Λ({y}) ∩ Λ({y ′ }) = ∅ if y, y ′ are noncrossing, and Λ({y}) ∩ Λ({y ′ }) = {si′ }
if y, y ′ are crossing (in which case, by Proposition 4.11, we have j = i′ + 1).
Proof. Let y = (i j) ∈ Ye . If j − i = 1, then (1) is clear. So assume j − i >
1; by Corollary 4.10 we have i = max(Ba ) or j = min(Ba+1 ) (and not both).
Suppose without loss of generality that i = max(Ba ), so j 6= min(Ba+1 ). For each
k = i + 1, . . . , j, we have (i k) ≤ (i j) by Lemma 4.6 and so (i k) ∈ Λ({y}) by
Observation 4.5. Furthermore, these are all of the elements of Λ({y}) since the
other candidates (i′ j ′ ) with i < i′ < j ′ ≤ j are not in Ye by Observation 4.5 and
the fact that such i′ , j ′ lie in the same block Ba+1 . This proves (1).
Now let y = (i j), y ′ = (i′ j ′ ) ∈ Ye be incomparable, with i < i′ . Then j ′ > j.
If y, y ′ are noncrossing, then i′ ≥ j, and it is clear by the previous paragraph that
Λ({y}) and Λ({y ′ }) are disjoint. Otherwise i < i′ < j < j ′ , so y and y ′ are crossing
and, by Proposition 4.11, j = i′ + 1. In this case Λ({y}) = {(k j) | i ≤ k < j}
and Λ({y ′ }) = {(i′ k′ ) | i′ < k′ ≤ j ′ }, whose intersection is {(i′ j)} = {si′ }, proving
(2).

Proposition 4.13. Let v ∈ W = Sn and let I be any hypercube decomposition of
[e, v]. Let Y ∈ Ae and let Y = Y1 ⊔ · · · ⊔ Yc be its decomposition according to the
camels of Car(Y ).
(1) For each 1 ≤ a ≤ c, θe (Ya ) is given by the product of the elements of Ya in
some order.
Q
(2) The {θe (Ya )} commute and θe (Y ) = ca=1 θe (Ya ).

Proof. We prove (1) by induction on |Ya |.
If |Ya | = 2, then Ya = {(i1 i2 ), (i2 i3 )} for some i1 < i2 < i3 . It is easy to see
that there are exactly two diamonds in Γ spanned by Ya : one with top (i1 i2 )(i2 i3 )
and the other with top (i2 i3 )(i1 i2 ). Since I is a hypercube decomposition, exactly
one of these two elements lies in [e, v] and this element is by definition θe (Ya ). Now
suppose that |Ya | ≥ 3. For each y ∈ Ya we have by induction that θe (Ya \ {y}) is a
product of Ya \ {y} in some order. Moreover, these products are compatible in the
sense that there is a product η of the elements of Y with θe (Ya \ {y}) → η for all
y ∈ Ya (a priori η need not be in [e, v]). On the other hand, θe (Ya \ {y}) → θe (Ya )
for all y ∈ Ya . If η 6= θe (Ya ), then we have a directed complete bipartite subgraph
K3,2 of Γ. But by [Dye91, Lemma 3.1], no such subgraph of the Bruhat graph of Sn
exists: if there were one, then there would be one in a rank-two reflection subgroup

18

GRANT T. BARKLEY AND CHRISTIAN GAETZ

S3 or S1 × S1 , but an easy check shows that there is not. Thus η = θe (Ya ) and we
have proven (1).
Let y ∈ Ya and y ′ ∈ Ya′ , for a 6= a′ . Then y and y ′ commute since no element of
[n] is moved by both
Qcpermutations. Thus, by (1), θe (Ya ) and θe (Ya′ ) commute. The
fact that θe (Y ) = a=1 θe (Ya ) can be argued as in part (1).

Proposition 4.14. Let v ∈ W = Sn and let I be any hypercube decomposition of
[e, v]. Let Y ∈ Ae and let Y = Y1 ⊔ · · · ⊔ Yc be its decomposition according to the
camels C1 ≺ · · · ≺ Cc of Car(Y ).
(1) If Ya = {(i1P
i2 ), (i2 i3 ), · · · , (id id+1 )}, then ℓ(θe (Ya )) = 2(id+1 − i1 ) − d.
(2) ℓ(θe (Y )) = ca=1 ℓ(θe (Ya )) − 2 cr(Y ).

Proof. A reduced word for a reflection t = (ij) contains simple reflections si , . . . , sj−1 .
These sets of simple reflections for t ∈ Ya are disjoint, so the product of the elements
of Ya in any order is length-additive. Thus by Proposition 4.13(1) we have
ℓ(θe (Ya )) =

d
X

d′ =1

ℓ((id′ id′ +1 )) =

d
X

(2(id′ +1 − id′ ) − 1) = 2(id+1 − i1 ) − d,

d′ =1

proving (1).
Q
Now, we have θe (Y ) = ca=1 θe (Ya ) by Proposition 4.13(2). Since this product
commutes, we can take it in the order θe (Y1 ) · · · θe (Yc ). The sets of simple reflections
appearing in each factor are now disjoint except that there is a single simple reflection
in DR (θe (Yi )) ∩ DL (θe (Yi+1 )) (where DR and DL denote right and left descent sets,
respectively) when Ci and Ci+1 are crossing. Canceling these in the product yields
(2).

Lemma 4.15. Let v ∈ W = Sn , let I be any hypercube decomposition of [e, v], and
let Y ∈ Ae . Let η = y1 · · · y|Y | be the product of the elements of Y in some order.
Then there is a hypercube subgraph of Γ spanned by Y with top element η (note that
η may not lie in [e, v]).
Proof. The formulas in Proposition 4.14 remain valid for the product η, with the
same proofs. If ya = (i i + 1) then ya does not cross any other arcs from Y , and
if ya = (i i + 2) then ya crosses at most one arc, by Proposition 4.11. Thus by
examining Proposition 4.14, we see that deleting any term in the product yields an
η ′ with ℓ(η ′ ) < ℓ(η). Since this deletion corresponds to multiplying by a reflection
y1 y2 · · · ya · · · y2 y1 , we conclude that η ′ → η. Finally, note that each ya contains
some simple reflection in its support not contained in the support of any other ya′ .
This ensures that deleting two different subsets of the terms of the product yields
different elements.

4.3. Proof of Theorem 4.1. We are now ready to prove Theorem 4.1, the main
result of Section 4.

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

19

Proof of Theorem 4.1. Let v ∈ W = Sn and fix a hypercube decomposition I of
[e, v]. Let Y ∈ Ae be an antichain.
We first prove (i). Suppose that Γ(e, v) has a subgraph:
w
θe (Y ∪ {y ′ }),

θe (Y ∪ {y})

(7)

t

θe (Y )

t′

where Y ∪ {y}, Y ∪ {y ′ } ∈ Ae . We need to show that Y ∪ {y, y ′ } ∈ Ae and that
θe (Y ∪ {y, y ′ }) = w.
Suppose that Y ∪ {y, y ′ } 6∈ Ae , so, without loss of generality, we must have
y < y ′ . By Lemma 4.6 and Corollary 4.10, these elements are of the form y = (i j)
and y ′ = (i j ′ ) for some i < j < j ′ (or y = (i j) and y ′ = (i′ j) with i′ < i < j which is
analogous). By Proposition 4.13 we know that θe (Y ∪ {y ′ }) = y1 · · · ya y ′ ya+1 · · · y|Y |
for some ordering y1 , . . . , y|Y | of Y and some a. This word is length-additive with the
exception of the cancellation of some descents of consecutive reflections, as discussed
in the proof of Proposition 4.14. By the subword property (after accounting for
this cancellation) we see that η := y1 · · · ya yya+1 · · · y|Y | < θe (Y ∪ {y ′ }) < v. By
Lemma 4.15, we conclude that η is the top of a hypercube subgraph of Γ(e, v)
spanned by Y ∪{y}. By the uniqueness of hypercubes, this implies that θe (Y ∪{y}) =
η < θe (Y ∪ {y ′ }). A case check shows that any diamond subgraph of Γ whose two
middle vertices are comparable in Bruhat order must be spanned by reflections
(i1 i4 ) and (i2 i3 ) with i1 < i2 < i3 < i4 and x(i1 ) < x(i2 ) < x(i3 ) < x(i4 ), where
x is the bottom vertex of the diamond. Applying this to the diamond (7), yields
as contradiction, as the reflections t, t′ spanning this diamond are conjugates of y
and y ′ by the same permutation (since θe (Y ) = y1 · · · y|Y | , again by uniqueness of
hypercubes) and hence do not commute. Thus Y ∪ {y, y ′ } ∈ Ae .
At least one of the upper two edges of any diamond, such as (7), spanned by
edges labeled t, t′ must also be labeled t or t′ . From this we deduce that w =
y1 · · · ya ζζ ′ ya+1 · · · y|Y | , where {ζ, ζ ′ } = {y, y ′ }. Lemma 4.15 now guarantees that w
is the top of a hypercube spanned by Y ∪{y, y ′ }, and hence is equal to θe (Y ∪{y, y ′ }).
This proves (i).
We now prove (ii). Let Y1 ⊔ · · · ⊔ Yc be the decomposition of Y according to
the camels C1 ≺ · · · ≺ Cc of Car(Y ). Since the arcs within each camel Ya are
noncrossing, Proposition 4.12 implies that |Λ(Ya )| = max(Ca ) − min(Ca ) (the result
of a telescoping sum). On the other hand, by Proposition 4.14(1) we have
ℓ(θe (Ya )) + |Ya |
= max(Ca ) − min(Ca ) = |Λ(Ya )|.
2
Then by Proposition 4.12(2) and Proposition 4.11(3) we see that
X
|Λ(Y )| =
|Λ(Ya )| − cr(Y )
La :=

a

20

GRANT T. BARKLEY AND CHRISTIAN GAETZ

and by Proposition 4.14(2) we have
P
P
c
( ca=1 ℓ(θe (Ya )) − 2 cr(Y )) + ca=1 |Ya | X
ℓ(θe (Y )) + |Y |
La −cr(Y ) = |Λ(Y )|.
=
=
2
2
a=1

This proves (ii).
Finally, I has property (E) by Corollary 3.12.



Proof of Theorem 1.3. The theorem follows immediately from Theorem 4.1 and
Corollary 3.9.

References
[BB05]

A. Björner and F. Brenti. Combinatorics of Coxeter groups, volume 231 of Graduate
Texts in Mathematics. Springer, New York, 2005.
[BBDVW] C. Blundell, L. Buesing, A. Davies, P. Veličković, and G. Williamson. Towards combinatorial invariance for Kazhdan-Lusztig polynomials. Represent. Theory, 26:1145–1191,
2022. doi:10.1090/ert/624.
[BCM06] F. Brenti, F. Caselli, and M. Marietti. Special matchings and Kazhdan-Lusztig polynomials. Adv. Math., 202(2):555–601, 2006. doi:10.1016/j.aim.2005.01.011.
[BFL99]
S. C. Billey, C. K. Fan, and J. Losonczy. The parabolic map. J. Algebra, 214(1):1–7,
1999. doi:10.1006/jabr.1998.7687.
[BG24]
G. T. Barkley and C. Gaetz. On combinatorial invariance of parabolic Kazhdan-Lusztig
polynomials, 2024. arxiv:2404.04246 [math.CO].
[BG25]
G. T. Barkley and C. Gaetz. Combinatorial invariance for Kazhdan-Lusztig Rpolynomials of elementary intervals. Math. Ann., (to appear). arxiv:2303.15577
[math.CO].
e2 .
[BLP22]
G. Burrull, N. Libedinsky, and D. Plaza. Combinatorial invariance conjecture for A
Int. Math. Res. Not. IMRN, 2022. doi:10.1093/imrn/rnac105.
[BM25]
F. Brenti and M. Marietti. Kazhdan–Lusztig R-polynomials, combinatorial invariance, and hypercube decompositions. Math. Z., 309(2):Paper No. 25, 2025.
doi:10.1007/s00209-024-03632-3.
[Bre04]
F. Brenti. The intersection cohomology of Schubert varieties is a combinatorial invariant. European J. Combin., 25(8):1151–1167, 2004. doi:10.1016/j.ejc.2003.10.011.
[dC03]
F. du Cloux. Rigidity of Schubert closures and invariance of Kazhdan-Lusztig polynomials. Adv. Math., 180(1):146–175, 2003. doi:10.1016/S0001-8708(02)00100-7.
[Del06]
E. Delanoy. Combinatorial invariance of Kazhdan-Lusztig polynomials on intervals starting from the identity. J. Algebraic Combin., 24(4):437–463, 2006.
doi:10.1007/s10801-006-0014-7.
[DVB+ 21] A. Davies, P. Veličković, L. Buesing, S. Blackwell, D. Zheng, N. Tomašev, R. Tanburn,
P. Battaglia, C. Blundell, A. Juhász, et al. Advancing mathematics by guiding human
intuition with AI. Nature, 600(7887):70–74, 2021.
[Dye87]
M. Dyer. Hecke algebras and reflections in Coxeter groups. PhD thesis, University of
Sydney, 1987.
[Dye91]
M. Dyer. On the “Bruhat graph” of a Coxeter system. Compositio Math., 78(2):185–191,
1991. URL http://www.numdam.org/item?id=CM_1991__78_2_185_0.
[EMBG24] F. Esposito, M. Marietti, G. T. Barkley, and C. Gaetz. A note on combinatorial invariance of Kazhdan–Lusztig polynomials, 2024. arxiv:2404.12834 [math.CO].
[GW23]
M. Gurevich and C. Wang. Parabolic recursions for Kazhdan-Lusztig polynomials and
the hypercube decomposition, 2023. arxiv:2303.09251.

THE BBDVW CONJECTURE FOR KL POLYNOMIALS OF LOWER INTERVALS

[Inc06]
[Inc07]
[KL79]
[Pat21]

21

F. Incitti. On the combinatorial invariance of Kazhdan-Lusztig polynomials. J. Combin.
Theory Ser. A, 113(7):1332–1350, 2006. doi:10.1016/j.jcta.2005.12.003.
F. Incitti. More on the combinatorial invariance of Kazhdan-Lusztig polynomials. J.
Combin. Theory Ser. A, 114(3):461–482, 2007. doi:10.1016/j.jcta.2006.06.009.
D. Kazhdan and G. Lusztig. Representations of Coxeter groups and Hecke algebras.
Invent. Math., 53(2):165–184, 1979. doi:10.1007/BF01390031.
L. Patimo. A combinatorial formula for the coefficient of q in Kazhdan-Lusztig polynomials. Int. Math. Res. Not. IMRN, (5):3203–3223, 2021. doi:10.1093/imrn/rnz255.

(Barkley) Department of Mathematics, Harvard University, Cambridge, MA.
Email address: gbarkley@math.harvard.edu
(Gaetz) Department of Mathematics, University of California, Berkeley, CA.
Email address: gaetz@berkeley.edu

